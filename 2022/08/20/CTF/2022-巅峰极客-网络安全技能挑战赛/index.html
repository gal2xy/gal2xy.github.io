

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="gla2xy">
  <meta name="keywords" content="">
  
    <meta name="description" content="point-power1234567891011121314151617181920212223242526from Crypto.Util.number import *from gmpy2 import *from random import *from secrets import flagassert len(flag)&#x3D;&#x3D;42p&#x3D;getPrime(600)a&#x3D;bytes_to_long(">
<meta property="og:type" content="article">
<meta property="og:title" content="2022-巅峰极客-网络安全技能挑战赛">
<meta property="og:url" content="http://example.com/2022/08/20/CTF/2022-%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/index.html">
<meta property="og:site_name" content="gla2xy&#39;s blog">
<meta property="og:description" content="point-power1234567891011121314151617181920212223242526from Crypto.Util.number import *from gmpy2 import *from random import *from secrets import flagassert len(flag)&#x3D;&#x3D;42p&#x3D;getPrime(600)a&#x3D;bytes_to_long(">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-08-20T12:49:36.000Z">
<meta property="article:modified_time" content="2022-09-11T13:57:40.782Z">
<meta property="article:author" content="gla2xy">
<meta property="article:tag" content="ECC">
<meta property="article:tag" content="RSA-CRT Fault Attack">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>2022-巅峰极客-网络安全技能挑战赛 - gla2xy&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  



  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>gal2xy&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2022-巅峰极客-网络安全技能挑战赛"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-08-20 20:49" pubdate>
          2022年8月20日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          14k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          118 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2022-巅峰极客-网络安全技能挑战赛</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="point-power"><a href="#point-power" class="headerlink" title="point-power"></a>point-power</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)==<span class="hljs-number">42</span><br>p=getPrime(<span class="hljs-number">600</span>)<br>a=bytes_to_long(flag)<br>b=randrange(<span class="hljs-number">2</span>,p-<span class="hljs-number">1</span>)<br>E=EllipticCurve(GF(p),[a,b])<br>G=E.random_element()<br><br>x1,y1,_=G<br>G=<span class="hljs-number">2</span>*G<br>x2,y2,_=G<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;b = <span class="hljs-subst">&#123;b&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;x1 = <span class="hljs-subst">&#123;x1&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;x2 = <span class="hljs-subst">&#123;x2&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 3660057339895840489386133099442699911046732928957592389841707990239494988668972633881890332850396642253648817739844121432749159024098337289268574006090698602263783482687565322890623</span><br><span class="hljs-string">b = 1515231655397326550194746635613443276271228200149130229724363232017068662367771757907474495021697632810542820366098372870766155947779533427141016826904160784021630942035315049381147</span><br><span class="hljs-string">x1 = 2157670468952062330453195482606118809236127827872293893648601570707609637499023981195730090033076249237356704253400517059411180554022652893726903447990650895219926989469443306189740</span><br><span class="hljs-string">x2 = 1991876990606943816638852425122739062927245775025232944491452039354255349384430261036766896859410449488871048192397922549895939187691682643754284061389348874990018070631239671589727</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>椭圆曲线基础知识</p>
<p>一般方程：$ y^2&#x3D;x^3+ax+b $ (忘记了左边是平方，搞了蛮久还不知道自己错哪了)</p>
<p>因为有$(x2,y2)&#x3D;2(x1,y1)$，所以可以连立方程</p>
<p>有如下等式<br>$$<br>\begin{cases} y_1^2&#x3D;x_1^2+ax_1+b\\<br>y_2^2&#x3D;x_2^2+ax_2+b\\<br>k&#x3D;\dfrac{3x_1^2+a}{2y_1}\\<br>x_2&#x3D;-2x_1+k^2 \end{cases}<br>$$<br>化简有<br>$$<br> 4(x_1^3+ax_1+b)(2x_1+x_2)-(3x_1^2+a)&#x3D;0<br>$$<br>在$GF(p)$上解该方程即可得到 $a$。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">3660057339895840489386133099442699911046732928957592389841707990239494988668972633881890332850396642253648817739844121432749159024098337289268574006090698602263783482687565322890623</span><br>b = <span class="hljs-number">1515231655397326550194746635613443276271228200149130229724363232017068662367771757907474495021697632810542820366098372870766155947779533427141016826904160784021630942035315049381147</span><br>x1 = <span class="hljs-number">2157670468952062330453195482606118809236127827872293893648601570707609637499023981195730090033076249237356704253400517059411180554022652893726903447990650895219926989469443306189740</span><br>x2 = <span class="hljs-number">1991876990606943816638852425122739062927245775025232944491452039354255349384430261036766896859410449488871048192397922549895939187691682643754284061389348874990018070631239671589727</span><br>R.&lt;a&gt; = PolynomialRing(Zmod(p), implementation=<span class="hljs-string">&#x27;NTL&#x27;</span>)<br><br>f = <span class="hljs-number">4</span>*(<span class="hljs-number">2</span>*x1+x2)*(x1^<span class="hljs-number">3</span> + a*x1 + b) - (<span class="hljs-number">3</span>*x1^<span class="hljs-number">2</span>+a)^<span class="hljs-number">2</span><br>f = f.monic()<br>root = f.roots()<br><span class="hljs-built_in">print</span>(root)<br><span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> root:<br>    m = <span class="hljs-built_in">int</span>(each[<span class="hljs-number">0</span>])<br>    <span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>



<h1 id="strange-curve"><a href="#strange-curve" class="headerlink" title="strange curve"></a>strange curve</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">P,Q</span>):<br>    (x1,y1)=P<br>    (x2,y2)=Q<br><br><br>    x3=(x1+x2)*(<span class="hljs-number">1</span>+y1*y2)*invert((<span class="hljs-number">1</span>+x1*x2)*(<span class="hljs-number">1</span>-y1*y2),p)%p<br>    y3=(y1+y2)*(<span class="hljs-number">1</span>+x1*x2)*invert((<span class="hljs-number">1</span>-x1*x2)*(<span class="hljs-number">1</span>+y1*y2),p)%p<br><br>    <span class="hljs-keyword">return</span> (x3,y3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>(<span class="hljs-params">e,P</span>):<br>    Q=(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br>    e=e%p<br>    <span class="hljs-keyword">while</span> e:<br>        <span class="hljs-keyword">if</span> e&amp;<span class="hljs-number">1</span>:<br>            Q=add(Q,P)<br>        P=add(P,P)<br>        e&gt;&gt;=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> Q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Legendre</span>(<span class="hljs-params">a,p</span>):<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">pow</span>((a%p+p)%p,(p-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>,p))%p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ts</span>(<span class="hljs-params">p</span>):<br>    p=p-<span class="hljs-number">1</span><br>    count=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> p%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>:<br>        count+=<span class="hljs-number">1</span><br>        p=p//<span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> count,p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_nonre</span>(<span class="hljs-params">p</span>):<br>    a=random.randint(<span class="hljs-number">1</span>,p)<br>    <span class="hljs-keyword">while</span> Legendre(a,p)==<span class="hljs-number">1</span>:<br>        a=random.randint(<span class="hljs-number">1</span>,p)<br>    <span class="hljs-keyword">return</span> a<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">amm2</span>(<span class="hljs-params">a,p</span>):<br>    t,s=get_ts(p)<br>    ta=<span class="hljs-built_in">pow</span>(get_nonre(p),s,p)<br>    tb=<span class="hljs-built_in">pow</span>(a,s,p)<br>    h=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,t):<br>        d=<span class="hljs-built_in">pow</span>(tb,<span class="hljs-number">2</span>**t-<span class="hljs-number">1</span>-i,p)<br>        <span class="hljs-keyword">if</span> d==<span class="hljs-number">1</span>:<br>            k=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            k=<span class="hljs-number">1</span><br>        tb=(tb*<span class="hljs-built_in">pow</span>(ta,<span class="hljs-number">2</span>*k,p))%p<br>        h=(h*<span class="hljs-built_in">pow</span>(ta,k,p))%p<br>        ta=<span class="hljs-built_in">pow</span>(ta,<span class="hljs-number">2</span>,p)<br>    <span class="hljs-keyword">return</span> h*<span class="hljs-built_in">pow</span>(a,(s+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>,p)%p  <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">a,b,c,p</span>):<br>    tmpa=<span class="hljs-number">1</span><br>    tmpb=b*inverse(a,p)%p<br>    tmpc=c*inverse(a,p)%p<br>    <span class="hljs-keyword">assert</span> Legendre(tmpb**<span class="hljs-number">2</span>*inverse(<span class="hljs-number">4</span>,p)-tmpc,p)==<span class="hljs-number">1</span><br>    res1=(amm2(tmpb**<span class="hljs-number">2</span>*inverse(<span class="hljs-number">4</span>,p)-tmpc,p)-tmpb*inverse(<span class="hljs-number">2</span>,p))%p<br>    res2=(-amm2(tmpb**<span class="hljs-number">2</span>*inverse(<span class="hljs-number">4</span>,p)-tmpc,p)-tmpb*inverse(<span class="hljs-number">2</span>,p))%p<br>    <span class="hljs-keyword">return</span> (res1,res2)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lift</span>(<span class="hljs-params">x,a,b,p</span>):<br>    tmp=b*(x**<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)*inverse(a*x,p)%p<br>    <span class="hljs-keyword">return</span> solve(<span class="hljs-number">1</span>,-tmp,-<span class="hljs-number">1</span>,p)[<span class="hljs-number">0</span>]<br><br>p=<span class="hljs-number">9410547699903726871336507117271550134683191140146415131394654141737636910570480327296351841515571767317596027931492843621727002889086193529096531342265353</span><br>a=<span class="hljs-number">54733430689690725746438325219044741824500093621550218736194675295708808435509</span><br>b=<span class="hljs-number">75237024593957256761258687646797952793573177095902495908321724558796076392871</span><br>x=bytes_to_long(flag)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">try</span>:<br>        y=lift(x,a,b,p)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">except</span>:<br>        x+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">continue</span><br><br><span class="hljs-keyword">assert</span> a*x*(y**<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)%p == b*y*(x**<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)%p<br><br>P=(x,y)<br>e=<span class="hljs-number">65537</span><br><br>eP=mul(e,P)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;P = <span class="hljs-subst">&#123;P&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;eP = <span class="hljs-subst">&#123;eP&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">P = (56006392793427940134514899557008545913996191831278248640996846111183757392968770895731003245209281149, 5533217632352976155681815016236825302418119286774481415122941272968513081846849158651480192550482691343283818244963282636939305751909505213138032238524899)</span><br><span class="hljs-string">eP = (mpz(8694229840573103722999959579565187489450818138005222030156495740841851804943200684116883831426548909867463656993852596745698999492932194245562062558787005), mpz(9279986963919197374405152604360936066932975197577643570458423456304679111057526702737279809805694360981565554506626018364382736924914907001214909905449002))</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>    <br></code></pre></td></tr></table></figure>

<p>非预期解。根据下面代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">try</span>:<br>        y=lift(x,a,b,p)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">except</span>:<br>        x+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure>

<p>所以我们只要对 $x$ 往下爆破就行了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>m = <span class="hljs-number">56006392793427940134514899557008545913996191831278248640996846111183757392968770895731003245209281149</span><br><span class="hljs-keyword">while</span> m!=<span class="hljs-number">0</span>:<br>    flag = long_to_bytes(m)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br>    m -= <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h1 id="learning-with-fault"><a href="#learning-with-fault" class="headerlink" title="learning_with_fault"></a>learning_with_fault</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RSA</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,p,q,e</span>):<br>        self.p=p<br>        self.q=q<br>        self.e=e<br>        self.phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>        self.d=invert(self.e,self.phi)<br>        self.dp=self.d%(p-<span class="hljs-number">1</span>)<br>        self.dq=self.d%(q-<span class="hljs-number">1</span>)<br>        self.n=p*q<br>        self.N=getPrime(<span class="hljs-number">512</span>)*getPrime(<span class="hljs-number">512</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sign</span>(<span class="hljs-params">self,message</span>):<br>        m=bytes_to_long(message)<br>        sig_p=<span class="hljs-built_in">pow</span>(m,self.dp,self.p)<br>        sig_q=<span class="hljs-built_in">pow</span>(m,self.dq,self.q)<br>        alpha=q*invert(q,p)<br>        beta=p*invert(p,q)<br>        <span class="hljs-keyword">return</span> long_to_bytes((alpha*sig_p+beta*sig_q)%self.n)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">corrupt_sign</span>(<span class="hljs-params">self,message</span>):<br>        m=bytes_to_long(message)<br>        sig_p=<span class="hljs-built_in">pow</span>(m,self.dp,self.p)<br>        sig_q=<span class="hljs-built_in">pow</span>(m,self.dq,self.q)<br>        alpha=q*invert(q,p)<br>        beta=p*invert(p,q)<br>        <span class="hljs-keyword">return</span> long_to_bytes((alpha*sig_p+beta*sig_q)%self.N)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">verify</span>(<span class="hljs-params">self,message,sign</span>):<br>        <span class="hljs-keyword">return</span> long_to_bytes(<span class="hljs-built_in">pow</span>(bytes_to_long(sign),self.e,self.n)) == message<br><br>p=getPrime(<span class="hljs-number">512</span>)<br>q=getPrime(<span class="hljs-number">512</span>)<br>e=<span class="hljs-number">65537</span><br>rsa=RSA(p,q,e)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;sign.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f1:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;corrupted_sign.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f2:<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>            message=os.urandom(<span class="hljs-number">64</span>)<br>            sign=rsa.sign(message)<br>            corrupted_sign=rsa.corrupt_sign(message)<br>            <span class="hljs-keyword">assert</span> rsa.verify(message,sign)<br>            f1.write(<span class="hljs-built_in">str</span>(sign)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>            f2.write(<span class="hljs-built_in">str</span>(corrupted_sign)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>enc=<span class="hljs-built_in">pow</span>(bytes_to_long(flag),rsa.e,rsa.n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;rsa.n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;N = <span class="hljs-subst">&#123;rsa.N&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;rsa.e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;enc = <span class="hljs-subst">&#123;enc&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 99670316685463632788041383175090257045961799409733877510733415402955763322569510896091638507050126669571444467488936880059210773298729542608112756526719533574432327269721804307073353651955251188547245641771980139488000798458617636759823027148955008149512692983471670488580994385743789385091027299901520585729</span><br><span class="hljs-string">N = 81332992898551792936282861980393365170738006789835182134055801566584228471896473385776004610279937176800796971820133195300006470892468060034368863410462219133248069442508287516929262751427926825122839525496671527936622212986733708071962237633082743396115729744192159064241674410003857168101669882043743570731</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">enc = 2476965183785968993595493003363618829317072815989584886372189393899395623714779397354978469504773556228655475355703015337932838278988328384587983506790841663233499939173166353582189202860394411808445422387063648198432242875738065748287034529713834303346017134249834382745931627301273142828893469374138264396</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>踏破铁鞋无觅处，得来全不费功夫。还得是La佬的博客香！😭</p>
<p><a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/#RSA-CRT">RSA | Lazzaro (lazzzaro.github.io)</a></p>
<p>论文参考：<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2011/388.pdf">CMBX12 (iacr.org)</a></p>
<p>看完之后并不是很懂（太菜了）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">import</span> gmpy2,sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">orthogonal_lattice</span>(<span class="hljs-params">B</span>):<br>    LB = B.transpose().left_kernel(basis=<span class="hljs-string">&quot;LLL&quot;</span>).basis_matrix()<br>    <span class="hljs-keyword">return</span> LB<br><br>n = <span class="hljs-number">99670316685463632788041383175090257045961799409733877510733415402955763322569510896091638507050126669571444467488936880059210773298729542608112756526719533574432327269721804307073353651955251188547245641771980139488000798458617636759823027148955008149512692983471670488580994385743789385091027299901520585729</span><br>N = <span class="hljs-number">81332992898551792936282861980393365170738006789835182134055801566584228471896473385776004610279937176800796971820133195300006470892468060034368863410462219133248069442508287516929262751427926825122839525496671527936622212986733708071962237633082743396115729744192159064241674410003857168101669882043743570731</span><br>e = <span class="hljs-number">65537</span><br>enc = <span class="hljs-number">2476965183785968993595493003363618829317072815989584886372189393899395623714779397354978469504773556228655475355703015337932838278988328384587983506790841663233499939173166353582189202860394411808445422387063648198432242875738065748287034529713834303346017134249834382745931627301273142828893469374138264396</span><br><br>cs_ = [<br>    <span class="hljs-string">b&quot;\x17\x8bb3\x11\x1b\xb9\xb9\xc6M\xb0\xaa\x07-\x1ar\xff\xfb\xb4&amp;H7!\xb8\xa1\xce\x07\x8b\x84M\x0bw=m\x193Oc\x97w\x8f\xffy4\xa1\x99\xfcW\xf9|\xeb\xa4\x00\x1eD*\xe8-&#x27;\xa9\xef\x9d\x13*\xf4\xbe\x9d\x9b&amp;w\xcb\xfd\xb3\xb6\xa3n\xb8\xb4\x97vT\xec@\x86\xd1R\xb0\n\xe1uC\xbc\x14\xeb\xceSu&amp;&#x27;&#123;\xb9\x12\x90\x82\xc7,\xdbr\xebP\xe1j\x11E\xd5\x17\xe1\xd0D\xe7z\x94vt\xbf\x1a\xc4+&quot;</span><br>    ,<span class="hljs-string">b&#x27;\x1dJ\xc5\xb2\xbe\x05\xe6\xc8T\n\xbe&quot;\xbeU\xed\xba\xec\x85\x05\x8b\x8ayE\xa3&#125;0\x1dk\xa7\x10\xe2E\x19\xfe\x10\x90\xef\r\xdbV\x8b\x87|(\xd1\xb5\xfd\xb9\x14\x84\x05\x03\x81\xc8\xf6\xe5\x8a\x92\xa0\x01I\x8aG:\xc19\x9e\xf0\x8eZ\\Yx\x80|\xb7\x80\x0e\xcd\xa3\xba6\xf8\x98\xb1pB\x05\x8aT#\xbf\x1e\x1b~\xcb\xf5\t\xa2H9\xc9n\x81e\xa2\x15\x97\x11\xe4\x93\xf2\xe6\x80\x97\x99G\xb5\xfe\x07/\xd2\xbd\xad\xcf\x04\x9e\xd0&#x27;</span><br>    ,<span class="hljs-string">b&#x27;Gs\xda\xb8\x8a\x85\xccK\xf7\xa8y\x16\xa5\xf0\x06\xbe\xeb\x83&amp;&#125;a\x85q\x8d:\x1fSb\xb8\xc5\x84\xba*[\xe7\xbb&#123;\x86\xd3\xb3r\xb6\xaaCN\x93\x1d&lt;(\xe2\x1c;\x8crU\x8fD=W\xa7\x0b\xc7\xeag\x96\x06\xd6\xbb\xe4\x04b\xd8\x02\x12\xd6\xfa2\x1e#\xf0\xde\x8b\x88M\xd2\xf47\\\x98\xe0\x04Fu\x1bsy\xf2\xc4\xad\xd6Y\x81u~B:\xd2\x1f\xb3\xab\x01:\xfa\xdf\x19J8\xd0\x18RN\xfe,CA\x15\xb3\xe0&#x27;</span><br>    ,<span class="hljs-string">b&quot;0I\xda5\x9f\x05v\x17\xdc\xd4q\xd6\x83,\x9d\r\xccc\x8a\xa1\xd4U\xd3\x18\xc9\xc6g\xcd\nX\x99Ah\xed&#125;\xf3\xb1(\xd5I\xc6\x0f@yw9\x9d\xfdv\x15x\xeaRA\xd6\xb0\x1e\xb5B\xe5\x05cc\x06m\xf4NN&#x27;\x02q\x1a\x11\xe4\x87P:\xc8\x11a\x9f\xbd\x9c\x98x\xda\xea\xc4\xa8f\x89s\xcaJ\x7f\xeb\xd8\xc1G#\xf4\xdc\xe2\x01\xf2\xa5\x95\x19`)2!\xf5\xb9\xf0\xf2\xbb\xf8\x0bF&amp;&amp;`\xfd*\xe1\xf2\x9c&quot;</span><br>    ,<span class="hljs-string">b&#x27;:\x99/Hxt\xd1\xd4\xaaB\xd6H\x16\xe1\xc9\xe2\xb3\xc3\xa9b\xd3\x96\x9c\x05x6\xf1\xc3d\xa2\xd1U+.\x1b\xac^\xf6Mh7\xb7\x03\x8e\xdc\xca\x0bn\xac\xed\x92\xb8x\x04)\x0f|\x11\xcc\xfa\xf2\\\xba\xee\xc4X\xa8(\x05\xf2\xb5\x8f&amp;\xf3\xff\x1eB\xe7\x94\xf4\xa6\x00!\xe5v\xd9x\xf0s\x94\xf4D(\xa9g\x118\xa7z\x83\xad\xdb\xe6\xe3\xe7\xf8\xf2\xef\xe5@\xe9\x13\x00OB\xcc\x05\xd1,_=\xd2/Og\x81\xa6+&#x27;</span><br>    ,<span class="hljs-string">b&#x27;\x1c|\xb6\xcc\xdfj\xc5\xa0s\xac w\xa6\xf2\x87D\xe3\xf9Y\xf5=\xf0\x0b\xd9\xea\x89,+e\x1e\xb7m#\x99\xd1\x87\x17Z\xed\x1d\xc8\x97;\xa0K\x05.\xaa&lt;\xc6s\xcf\xa2\xa2\\PO\x12&amp;\xb4\x11\xec\xad\x10\xf8\xf7\xd1\xd3_\x80\x17\xe0\x1eP\x93\xe3\xc2\x1e\x03\xea]^\xc6a\x9c\xcb\x90\xbb\x9f\x8by\xa5dhM\xce\xc7\xbc\xf7\xafe\xcf\xc1\xf1\x18@\x1e\xe2\xdb\xfb\xe4^\xc8\xe7\x19\xccnY\xc6o\x7fL\x9fV\xd4\xc4\x15\xe8&#x27;</span><br>]<br>s_ = [<br>    <span class="hljs-string">b&#x27;\t\x8b\xde\x98\x84\x1d\x9e\xd4\xa0\xb7f\xe0\x05\xb1\xbd8\xb9G\xe3\x0c\x83\x8a\xe5\xf0G7\x12\x1eT\x85o-B\xe4_\xd2\x04\xd9:\xab\xdf\xa1 \x8f\xedt+\x0f\xce\xb5\x90\xaaK\xf0U~v=\x84\xe7$G\xf5\xfb\xd3ok~V\x1a\xec&amp;\x15\x18Y\x0c\x80u\xafF\xf1\x10\x9f\xf2\xe6\xa6\x9a\xbb\xbd+\xa4l\xa9\x11\xd5\t\x13\x16\xa3\xde\xe1\xdfZ\xa9$r\xb5`\xc9&quot;\x11\xab\xc5\x87\xc4\x1d@\x9e\xa4t\xdb#\xbdj\xcb\x95\xefK&#x27;</span><br>    ,<span class="hljs-string">b&#x27;z/\xd6\xfb\xd8\xfa\xc4\xed\xbd\x99\xd0\xa0\x90\xcb\xca\x83\xd8B\xa7\xf4\xbd\xe0\xc2&amp;\x1aQl(\xd6p\x8f\x89=tT\xf1(\xeb\xab\x84[oR\x1fl=\xda\xf5\x18q\x8f\xa7k\x00\x1b\x1a\x0ei\x1fa.ho\x15\x04\x12\xe4\xc2\xd7\x19\x92\xc3\x9b\xfe\xd5\xb6R\xf8\x95\x9fr\x93\xddD\x1c[\x873\xd5\x06\x1b\xa5\x82/6\x9a\x13\xcf\xa4\xcd\x0e]\t\xad?\xd6\x84\r\x90\xef\x86\xf15)\xe34\xf7\xb77\xef\x0c&amp;\xdb8\xa6\xe0\xa5a&#x27;</span><br>    ,<span class="hljs-string">b&#x27;U\x0b\xf6\x9cm])1\xe2\xad\xf9G\x8f\xa2\xbc&#125;\xd7\x18\x89\xa4\xfdFQ\x80m&quot;\xf9\to^\xd9A\x98\xd2\xca\x1e(b\xa8\xbe\xc2m\xf7\n[O\x00\xbc\x87\x17\xed\x0cG\xf2=H\x0e\xc0\x14+\xcb\xd0\x1feT2\xf2Th\xec\xc2\xcf&gt;6,&lt;\x88X\x8f\xe9g\xa8\x00\xafr\x05\x95\rj\x9c\xc6\n\xbb\x8a\x019\xc1\x1ef#\x02[Rh\xd8\xdc|&#123;6\xeb\xe8U\x91\xa4\xeb&#125;\xf4s;E\xe72$i\xdft\xff\&#x27;&#x27;</span><br>    ,<span class="hljs-string">b&#x27;[\x94\x95T\xf4\xc4\xca\x8drO\x80\x14\xc9&lt;H\xa2a\xdc\xf4`\xac&gt;\xab\x03\xfa\x80Sx\x99\x14\x83$U\x0b\xfa\x8fv\xfd\xda\x1a\xa0\xebY\xaa\x01\xe2XsG\t\xcf\xae\xa0\xbf\x82iG\tQ \xb1\xfe\xa5k\x12\xd9\x12\xf7\x95\xa3\xa5\x8d`z\x19\x1a\x90-\x9aj\x15\xf6f&gt;\x18\x08\xb8\x1f\x88\x1a\x80Th\xd0\x15\x9bw#\&#x27;`K\xa5\xf1\xbf&quot;\xe79\xaf\xc7z%p\xa5\x9f\x14\xef\&#x27;1\x11\x05Gg\xe9\xda\xc9\x18~[&#x27;</span><br>    ,<span class="hljs-string">b&#x27;:\xefRE\xd7\xa1?\xf3\xb5\xf7\xdd\xe2\xb6~\x85014\xc0\x8a\x80\xe1\xb5#\x94\x10\xb2\xa0\xfe\x87\xd1t\xc3$&amp;\xde8\x195\xcd\xf4@3\x15\xcaK\xcc\xcd\r:\x83*\xd7l\xb6\xf2&#125; \tJ\xb5xKfjh.\xfb\xb5\x91\xc6\xf2x\x8e\x83\xdc\xc3\xef\x8b\x8dW\xa6\xa6\xb0w\xd8\xf2G\xa5-\xc3\x87\x17;\xedH`:\xcd\x08ts\x9eqPE\xd7\xfc\xc4\x98\xb5\xe0\xad\xb7A\x7f\xcb\x01\xbd\x98\xd3Ea\xb9\x07\x80\xf8\x19&#x27;</span><br>    ,<span class="hljs-string">b&quot;8\xca\x7f!;\\\xde\x1b\x80i\x9b!\x1c??u\x13\x955\xd0xG\xff\xd7\xba\xfe+\x95\x0eu^\x15\x1a\x0e*\xfe\x8a\xafM\xc0\xd1Ty\xd7\xf1\xa7@\xd6\xa6\xee\x0c:It\x1a\xeag\xfc\x0c\xaf\x02&lt;\x03T)\xeb\xb0\x15\x1cz\x85\x992\xa9\xbe\x9bm\xc4D\x83\xf7\xb5T\xdd9?\x94\xd4\x13\xb4\xb3\x8d\xa9\x92\x9dt\x86\xdb\x0b$\x19l\xb1\xb9\x05&#x27;o\xf3!\t\x01\x93&#x27;z\x15P\x88\xd7iN\n\x8bA\xb5\xd2&#125;\xe8\x10&quot;</span><br>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>    s_[i] = bytes_to_long(s_[i])<br>    cs_[i] = bytes_to_long(cs_[i])<br><br>l = <span class="hljs-number">6</span><br><br>v = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cs_)):<br>    v.append(<span class="hljs-built_in">int</span>(crt([s_[i], cs_[i]], [n, N])))<br>    <br>v = vector(ZZ, v)<br>Lv = orthogonal_lattice(Matrix(v))<br>L1 = orthogonal_lattice(Lv.submatrix(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, l-<span class="hljs-number">2</span>, l))<br>x, y = L1<br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">333</span>)):<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">333</span>)):<br>        z = a*x+b*y<br>        <span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> (v-z):<br>            tmp =  gcd(each,n)<br>            <span class="hljs-keyword">if</span> tmp&gt;<span class="hljs-number">1</span>:<br>                p = tmp<br>                <span class="hljs-built_in">print</span>(p)<br>                q = n//p<br>                <span class="hljs-keyword">assert</span> p*q == n<br>                phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>                d = gmpy2.invert(e,phi)<br>                m = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(enc,d,n))<br>                <span class="hljs-built_in">print</span>(long_to_bytes(m))<br>                sys.exit()<br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Crypto/" class="category-chain-item">Crypto</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/ECC/">#ECC</a>
      
        <a href="/tags/RSA-CRT-Fault-Attack/">#RSA-CRT Fault Attack</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2022-巅峰极客-网络安全技能挑战赛</div>
      <div>http://example.com/2022/08/20/CTF/2022-巅峰极客-网络安全技能挑战赛/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>gla2xy</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年8月20日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/08/20/CTF/%5B%E7%BE%8A%E5%9F%8E%E6%9D%AF%202020%5DSimple/" title="羊城杯-2020-Simple">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">羊城杯-2020-Simple</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/08/04/CTF/%E7%AC%AC%E5%85%AD%E5%B1%8A%E2%80%9C%E5%BC%BA%E7%BD%91%E6%9D%AF%E2%80%9D%E5%85%A8%E5%9B%BD%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B-%E7%BA%BF%E4%B8%8A%E8%B5%9B/" title="第六届“强网杯”全国网络安全挑战赛  线上赛">
                        <span class="hidden-mobile">第六届“强网杯”全国网络安全挑战赛  线上赛</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
