

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="gla2xy">
  <meta name="keywords" content="">
  
    <meta name="description" content="Ez_Pager_Tiper分析magic_box中的代码，测试发现malicious_magic中的now &#x3D; (-magic &amp; magic)的值取决于magic二进制末尾0的个数，即$now &#x3D; 2^{二进制末尾0的个数}$，进而每次执行该函数，magic的二进制中最后一个1改为0，故confusion函数中的循环次数为magic二进制中的1的个数。 再来看看confusi">
<meta property="og:type" content="article">
<meta property="og:title" content="SUSCTF - Ez_Pager_Tiper">
<meta property="og:url" content="http://example.com/2022/06/28/CTF/Ez_Pager_Tiper/index.html">
<meta property="og:site_name" content="gla2xy&#39;s blog">
<meta property="og:description" content="Ez_Pager_Tiper分析magic_box中的代码，测试发现malicious_magic中的now &#x3D; (-magic &amp; magic)的值取决于magic二进制末尾0的个数，即$now &#x3D; 2^{二进制末尾0的个数}$，进而每次执行该函数，magic的二进制中最后一个1改为0，故confusion函数中的循环次数为magic二进制中的1的个数。 再来看看confusi">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-06-28T04:11:43.000Z">
<meta property="article:modified_time" content="2022-07-28T12:13:14.177Z">
<meta property="article:author" content="gla2xy">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="流密码">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>SUSCTF - Ez_Pager_Tiper - gla2xy&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"y4ByOj1FL3SFodYp7tlkfLna-gzGzoHsz","app_key":"7E1eIfDTBkJaMJkiQI0jToXE","server_url":null,"path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>gal2xy&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="SUSCTF - Ez_Pager_Tiper"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        gla2xy
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-06-28 12:11" pubdate>
          2022年6月28日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          14k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          118 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">SUSCTF - Ez_Pager_Tiper</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Ez-Pager-Tiper"><a href="#Ez-Pager-Tiper" class="headerlink" title="Ez_Pager_Tiper"></a>Ez_Pager_Tiper</h1><p>分析<code>magic_box</code>中的代码，测试发现<code>malicious_magic</code>中的<code>now = (-magic &amp; magic)</code>的值取决于<code>magic</code>二进制末尾0的个数，即$now &#x3D; 2^{二进制末尾0的个数}$，进而每次执行该函数，<code>magic</code>的二进制中最后一个1改为0，故<code>confusion</code>函数中的循环次数为<code>magic</code>二进制中的1的个数。</p>
<p>再来看看<code>confusion</code>循环中的<code>output</code>的值。由于每次<code>now</code>都等于<code>magic</code>二进制中最后一个1及后面部分，于是乎在循环结束后<br>$$<br>\begin{align}<br>output &amp;&#x3D; output \oplus now_1\oplus now_2\oplus …\oplus now_n<br>\\&amp;&#x3D; output \oplus magic(最初始)<br>\\&amp;&#x3D;magic(最初始) \oplus c1 \oplus c2 \oplus magic(最初始)<br>\\&amp;&#x3D;c1 \oplus c2<br>\end{align}<br>$$<br>而每次循环中<code>cnt ^= 1</code>，故循环次数为偶数时（<code>magic</code>二进制中1的个数为偶数个）<code>cnt = 0</code>，反之则<code>cnt = 1</code>。</p>
<p>循环完后<code>output ^= cnt * c1</code>，故循环次数为偶数时<code>output = c1^c2</code>，反之则<code>output = c2</code>。</p>
<hr>
<p>根据上述分析可得<code>problem1</code>的加密简化为<code>ch ^ c2</code>，<code>problem2</code>的加密简化为<code>ch ^ c1 ^ c2</code>。</p>
<p>通过已知的部分文段可以分析文本格式以<code>Date: yyyy-mm-dd</code>作为开头，日期信息由文件名称b64decode得到。利用已知明文密文对，可以恢复lfsr的内部状态。</p>
<hr>
<h2 id="problem1"><a href="#problem1" class="headerlink" title="problem1"></a>problem1</h2><p>在<code>problem1</code>中由于<code>n2 = 12</code>，可以对<code>mask2</code>进行爆破，求出<code>mask2</code>后可以反推出（或爆破）<code>seed2</code>，于是就可以解密出对应的文本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> magic_box <span class="hljs-keyword">import</span> *<br><br>n1, n2 = <span class="hljs-number">64</span>, <span class="hljs-number">12</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;MTk4NC0wNC0wMQ==_6d30.enc&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    cipher1 = f.read()<br><br>date1 = <span class="hljs-string">&#x27;Date: 1984-04-01&#x27;</span><span class="hljs-comment">#少了个空格，淦！一个晚上就这么没了</span><br>known_output = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(date1)):<br>    bit8 = <span class="hljs-built_in">ord</span>(date1[i]) ^ cipher1[i]<br>    known_output += <span class="hljs-built_in">bin</span>(bit8)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)<br><br><span class="hljs-comment">#爆破mask2(12位bit)</span><br>mask2 = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> mask <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4096</span>):<br>    output = <span class="hljs-number">0</span><br>    lfsr2 = lfsr(<span class="hljs-built_in">int</span>(known_output[:n2],<span class="hljs-number">2</span>), mask, n2)<span class="hljs-comment">#known_output[:n2],否则就拿低位去&amp;了</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(known_output) - n2):<br>        output = (output &lt;&lt; <span class="hljs-number">1</span>) ^ lfsr2.<span class="hljs-built_in">next</span>()<br>    <span class="hljs-keyword">if</span> output == <span class="hljs-built_in">int</span>(known_output[n2:],<span class="hljs-number">2</span>):<br>        mask2 = mask<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;mask2 = <span class="hljs-subst">&#123;mask2&#125;</span>&#x27;</span>)<br><span class="hljs-comment">#爆破seed(12位bit)</span><br>seed2 = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4096</span>):<br>    output = <span class="hljs-number">0</span><br>    lfsr2 = lfsr(seed, mask2, n2)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(known_output)):<br>        output = (output &lt;&lt; <span class="hljs-number">1</span>) ^ lfsr2.<span class="hljs-built_in">next</span>()<br>    <span class="hljs-keyword">if</span> output == <span class="hljs-built_in">int</span>(known_output,<span class="hljs-number">2</span>):<br>        seed2 = seed<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;seed2 = <span class="hljs-subst">&#123;seed2&#125;</span>&#x27;</span>)<br><br>lfsr2 = lfsr(seed2,mask2,n2)<br><br>txt1 = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher1)):<br>    txt1 += <span class="hljs-built_in">chr</span>(lfsr2.getrandbit(<span class="hljs-number">8</span>) ^ cipher1[i])<br><br><span class="hljs-built_in">print</span>(txt1)<br></code></pre></td></tr></table></figure>

<p>结果如下</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">mask2 = <span class="hljs-number">2053</span><br>seed2 = <span class="hljs-number">2989</span><br><span class="hljs-symbol">Date:</span> <span class="hljs-number">1984</span><span class="hljs-number">-04</span><span class="hljs-number">-01</span><br>The pursuit was renewed, till the water was again muddied.  <span class="hljs-keyword">But </span>he could not <span class="hljs-keyword">wait. </span> He unstrapped the tin <span class="hljs-keyword">bucket </span><span class="hljs-keyword">and </span><span class="hljs-keyword">began </span>to <span class="hljs-keyword">bale </span>the pool.  He <span class="hljs-keyword">baled </span>wildly <span class="hljs-built_in">at</span> first, splashing himself <span class="hljs-keyword">and </span>flinging the water so <span class="hljs-keyword">short </span>a <span class="hljs-keyword">distance </span>that it ran <span class="hljs-keyword">back </span>into the pool.  He worked more carefully, striving to <span class="hljs-keyword">be </span>cool, though his heart was pounding against his chest <span class="hljs-keyword">and </span>his hands were trembling.  <span class="hljs-built_in">At</span> the end of half an hour the pool was nearly dry.  Not a cupful of water remained.  <span class="hljs-keyword">And </span>there was no fish.  He found a hidden crevice among the stones through which it had escaped to the adjoining <span class="hljs-keyword">and </span>larger poolâa pool which he could not empty in a night <span class="hljs-keyword">and </span>a day.  Had he known of the crevice, he could have <span class="hljs-keyword">closed </span>it with a rock <span class="hljs-built_in">at</span> the <span class="hljs-keyword">beginning </span><span class="hljs-keyword">and </span>the fish would have <span class="hljs-keyword">been </span>his.<br>Thus he thought, <span class="hljs-keyword">and </span>crumpled up <span class="hljs-keyword">and </span>sank down upon the wet earth.  <span class="hljs-built_in">At</span> first he cried softly to himself, then he cried loudly to the pitiless desolation that ringed him around<span class="hljs-comment">; and for a long time after he was shaken by great dry sobs.</span><br>He <span class="hljs-keyword">built </span>a fire <span class="hljs-keyword">and </span>warmed himself <span class="hljs-keyword">by </span>drinking quarts of hot water, <span class="hljs-keyword">and </span>made camp on a rocky ledge in the same fashion he had the night <span class="hljs-keyword">before. </span> The last thing he <span class="hljs-keyword">did </span>was to see that his matches were dry <span class="hljs-keyword">and </span>to wind his watch.  The <span class="hljs-keyword">blankets </span>were wet <span class="hljs-keyword">and </span>clammy.  His ankle pulsed with pain.  <span class="hljs-keyword">But </span>he knew only that he was hungry, <span class="hljs-keyword">and </span>through his restless sleep he dreamed of feasts <span class="hljs-keyword">and </span><span class="hljs-keyword">banquets </span><span class="hljs-keyword">and </span>of food served <span class="hljs-keyword">and </span>spread in all imaginable ways.<br>He awoke chilled <span class="hljs-keyword">and </span>sick.  There was no sun.  The gray of earth <span class="hljs-keyword">and </span>sky had <span class="hljs-keyword">become </span>deeper, more profound.  A raw wind was <span class="hljs-keyword">blowing, </span><span class="hljs-keyword">and </span>the first flurries of snow were whitening the hilltops.  The air about him thickened <span class="hljs-keyword">and </span>grew white while he made a fire <span class="hljs-keyword">and </span><span class="hljs-keyword">boiled </span>more water.  It was wet snow, half rain, <span class="hljs-keyword">and </span>the flakes were large <span class="hljs-keyword">and </span>soggy.  <span class="hljs-built_in">At</span> first they melted as soon as they came in contact with the earth, <span class="hljs-keyword">but </span>ever more fell, covering the ground, putting out the fire, spoiling his supply of moss-fuel.<br></code></pre></td></tr></table></figure>

<h2 id="problem2"><a href="#problem2" class="headerlink" title="problem2"></a>problem2</h2><p>由于<code>lfsr2</code>中的<code>n2 = 12</code>，故对<code>seed3</code>进行爆破，根据得出的<code>lfsr2流</code>推出<code>lfsr1流</code>。进而恢复<code>seed1</code>和<code>mask1</code>。从而对加密文本解密，筛选出flag。</p>
<p>（嗯！这个BM算法还没搞懂，贴一下别人的代码，from DengFeng）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> libnum<br>n1, n2 = <span class="hljs-number">64</span>, <span class="hljs-number">12</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">lfsr</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed, mask, length</span>):<br>        self.length_mask = <span class="hljs-number">2</span> ** length - <span class="hljs-number">1</span><br>        self.mask = mask &amp; self.length_mask<br>        self.state = seed &amp; self.length_mask<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        next_state = (self.state &lt;&lt; <span class="hljs-number">1</span>) &amp; self.length_mask<br>        i = self.state &amp; self.mask &amp; self.length_mask<br>        output = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> i != <span class="hljs-number">0</span>:<br>            output ^^= (i &amp; <span class="hljs-number">1</span>)<br>            i = i &gt;&gt; <span class="hljs-number">1</span><br>        next_state ^^= output<br>        self.state = next_state<br>        <span class="hljs-keyword">return</span> output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getrandbit</span>(<span class="hljs-params">self, nbit</span>):<br>        output = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbit):<br>            output = (output &lt;&lt; <span class="hljs-number">1</span>) ^^ self.<span class="hljs-built_in">next</span>()<br>        <span class="hljs-keyword">return</span> output<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_key</span>(<span class="hljs-params">mask,key,degree</span>):<br>    R = <span class="hljs-string">&quot;&quot;</span><br>    index = <span class="hljs-number">0</span><br>    key = key[degree-<span class="hljs-number">1</span>] + key[:degree]<br>    <span class="hljs-keyword">while</span> index &lt; degree:<br>        tmp = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(degree):<br>            <span class="hljs-keyword">if</span> mask &gt;&gt; i &amp; <span class="hljs-number">1</span>:<br>                <span class="hljs-comment"># tmp ^= int(key[255 - i])</span><br>                tmp = (tmp+<span class="hljs-built_in">int</span>(key[degree-<span class="hljs-number">1</span>-i]))%<span class="hljs-number">2</span><br>        R = <span class="hljs-built_in">str</span>(tmp) + R<br>        index += <span class="hljs-number">1</span><br>        key = key[degree-<span class="hljs-number">1</span>] + <span class="hljs-built_in">str</span>(tmp) + key[<span class="hljs-number">1</span>:degree-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(R,<span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_int</span>(<span class="hljs-params">x,degree</span>):<br>    m=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(degree):<br>        m += <span class="hljs-built_in">str</span>(x[i])<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(m,<span class="hljs-number">2</span>))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">BM</span>(<span class="hljs-params">r,degree</span>):<br>    a=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(r)):<br>        a.append(<span class="hljs-built_in">int</span>(r[i]))       <span class="hljs-comment">#将 r 转换成列表a = [0,0,1,...,]格式    </span><br>    res = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(degree):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(degree):<br>            <span class="hljs-keyword">if</span> a[i+j]==<span class="hljs-number">1</span>:<br>                res.append(<span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">else</span>:<br>                res.append(<span class="hljs-number">0</span>)<br>    sn = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(degree):<br>        <span class="hljs-keyword">if</span> a[degree+i]==<span class="hljs-number">1</span>:<br>            sn.append(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">else</span>:<br>            sn.append(<span class="hljs-number">0</span>)<br>    MS = MatrixSpace(GF(<span class="hljs-number">2</span>),degree,degree)        <br>    MSS = MatrixSpace(GF(<span class="hljs-number">2</span>),<span class="hljs-number">1</span>,degree)         <br>    A = MS(res)<br>    s = MSS(sn)                       <span class="hljs-comment">#将 res 和 sn 的值导入矩阵空间中</span><br>    <span class="hljs-keyword">try</span>:<br>        inv = A.inverse()            <span class="hljs-comment"># 求A 的逆矩阵</span><br>    <span class="hljs-keyword">except</span> ZeroDivisionError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>,-<span class="hljs-number">1</span><br>    mask = s*inv <br>    <span class="hljs-keyword">return</span> get_key(get_int(mask[<span class="hljs-number">0</span>],degree),r[:degree],degree),get_int(mask[<span class="hljs-number">0</span>],degree)<br><br>seed2 = <span class="hljs-number">2989</span><br>mask2 = <span class="hljs-number">2053</span><br><br>date2 = <span class="hljs-string">b&#x27;Date: 1984-12-25&#x27;</span><br>cipher2 = <span class="hljs-string">b&#x27;\x18\xff\xa57\xa65&quot;\x00\xfd/\x8d\x06\xe7z\xa4\xe6\t$\xec\x94$`\xaalB\xb6\x90`\x9e\&#x27;7\x9f\xcca\xaa1\x96\x19\t\xa2\xb8U\xde\xc5\xa0\xc7\xd23\xcd\xa0\xafRHP\x90\x8a\xa9M\x17@\xef8:]\xe1\xdc\x10\xad\xdfI\x04=\x01\x82\x1a\xec\x1e\x19\xdaV\x95\xc1K\x86\xfdZ\x90O7r\xeeZCewY8\xf1\x80\x81\x16NC\x94\xb0\xa0&lt;\xd5\xc9\x1a\xeb.\xf6\xaa\xbb\xa6\x9a&lt;t\xce\xdcQ$\xfdK\x89v\xee\xe0\x9dc\x9b6\xe6\xf0\xc9\xb6[l\xd3\xdc\xf8\n\xb7\xc6\xf9^\x0eIr\&#x27;&gt;\x1dD!\x83\xfd\xc6Q\xf9\xce\xee%\xa7l\xb9\xfc\xcc\xf9;\x0b\x04\xce\x07\x97\xae\xf5C\xa5\x96\xfeU\xe8\xfb\x06\x96\xe3Dr\x8a\xc8\xb7\xa0\xe4s\xe3\xac\x9dT\t\x0eL*Vys\x03\xbb\xf2$\xa8pR\x8c\xa8h\xf6\x04&lt;I4@&#125;\xe5\x12\x8d\x14\xbe\xe4\xb1\x86V`\xcf\x9bE\x8e\xf0m\xbd\xedP\xe3\xafo7\xbd\xb1\xb9R\x9a2*\xaabz@\xb2\xf9\xf59c\xf9\x13\xf12\x8b\xc2z\xda\xf4\x87\x130\xc2\x93\xf3\xce\x84\xe8q.\x01\xeec\xb1\x10X\xcd\x00\x91%\xb7|yW\xf2\xc4\xb3\x997\xc1\xb45\xe5)K \xfc\x93\x04\xee-\xf9\xc3\x06Js\xe1\tZ\x86=k8:\x17\x9e&#125;\xb1$\xce\xaa\xbc\x05\x97d\x83c~\xf57\x02\x08\xa2\tHz\xecq\x07Y\xe6&#125;\xf8\xf0\xaa\x00\x1e\x12f\xf5\xab\xf62u\x12\xf5\xcfx\xc3)B\xd4\xd1\x9dxX\x0b#\x9f\xf1\xa0&quot;\xb9M\xe9\xcf\x17\xc9\\\xbf\xf3y\xb1E\xc0\xa1\x88\x83\x95\xa6\xc9\xde=Md\xaf\xb4\x14\x815;\x18X\x9bQ2\x86\xa0`x&#123;\x18\xde\xean\xcd\xc3*y\x82\x8c\xe4l\x88\x96\xb7\x0e\x03u\xe7\xe8.&quot;!\xfb\xb1Bg\xea\xa2`\x99\xab\xa4d\xedA\x0e\x86\xd5\xaf5D\&#x27;\xcd3\xbf\xcd5\xb4\xc3^\xfe\x14t\x90\xf9\x01\x98\xd5~s\xdc\xa7\xb1\x8d\xf6\xd9\x92\xb9\xe0\x996?\x8f\\\x1d\xb2\x12\x97\xf6\x07;\xfaTL\x92.\xaf\x16$\xfa\x94\xcb0\xbf\x8a\xad](\xc6&#125;K\xc87\xfc\xc9\xc6\xdb\x08\x99\x9f(&lt;\x1e\x97\xe1\x00^\x13]\x16\xe13\xee\xebS1h\xdd\xe11n\x1a\xe6\x12\x01\xb5\x0c|\xf5\x8a\xbd=5S\xe4\xf9$\xf1\xedp\xce\x1f\x96.\x97\xe4;\x02 \x17&amp;\xd7\xd9*\x1f\xa4u\xe6\xad\xfd\xbaIR\x1f\x1a=F\xbf\xf3\x07\x19!=\xf7\xd8/\xe4i\xc6+\x9c5^t\x7f\xb2\x06\xe8\xf2\xac=\x16\x00r\xdd\x7f\xe34w\xde)\x86\x82\xb6gj\xf4\xfa\x18Pd\xd9\x82\xcd\xda\xee\x8bv\xd1NKu\\\x04\xe2\xbbt\x94\x82\x11\xc9\x1d\xdd\xb1\xb5\x8c\x86\xbfg\xa8L\x1eI\xb4\xddF\x8b\xa7\xd1\x16\x9c\x80\x94UXS\x13\x91\xf8\xe6=\x15\x16\x9a,\x0b8\xd2\xfeE\xa04&quot;\xaa1&#125;\xc7\x93\x9f\xb2%p\xb4\x01\x17r*\xd5\xc6\xfd\xfb\xb0&lt;\x18j\x86\xab\xe0\x17\xf2R\xdfZ\xc3Ty\xe9\xd2j\x8b\x15\t\xabrHwi~1K\x89\xebVZ\xec&#125;\x1av\xc5\x90\xb7\xa5$k\xd3&quot;\x05\xfa\xc6\x1d\xfe\xb5\x9e;#ig\xdd\xa3\x9b.[\x96\xf1r\x01D\xe7\xdeqkj%\x9cvU\xec\x04\xb0\xab\x9e4\x13\xd7\x07\xa8\xcarK&lt;-\xd1x\xb7|\xdf\xc5c\x13R\xd9\x1b\xd8\xa0=F\xbc9\xf2\x8c\xfc\xe8KO\xb6bfv\xaf\xb3\x9c\xa4\x1f(\xc4O\xa9\x0f]x\x832\x89\xd9\xc77\x1fa0\xe4\xac\xa7AA\xc4\x14\x9cm\xd5\xf0\x02\xb4\x9c(ej\xdb\x88U\xa7!+\x83]N\xee\x8c\x87*\x84W\x12$\xfc\x0eEC\xcb\x14\x88\x1eEr\x12N\x8fY\xd6\x18\x8b^\x98z\xbf\x84\xc1\xc8!\x8a\x1a\xaaQ\x89aP\xadL\xa4w\xda\xb9WN\x90\xe1\x9e\xcf\x1fx\xc7\x84\xf4\x0f\x9a8Q\xcc-\xbasuc0\x988\xf8&quot;\xecmFeI?\x13m1\x11D\xe3l\x0b\x16\xf7\xa4\x05[\xd0\xeac\x16\xc6\n`\xcf\xbcf\xda\xc6\xf8n\xbc\xea*\x857n\xb2\x91\x12#\xe0\xf9\x12\xc3\x83\x8f\xfb\x1b\xb2\xd8\xf6\x1fmwC\xaa\x8b\xaeV\xabQ\xd3\xe2\xd6\x1e\xf1u\xc5\xfd\x8a\xf7rw\&#x27;\x12\x95\x9dl:o\r\r\x13\xf9\x02\xab\&#x27;.&#123;\xc0b\x9f\xc1.\xde\xeb\xce\xf1Cd\xbf\xdfOAMi\xc3\x96bhC\xc7\xa6\x1ch\x06X\xed\xafR\xda\x80\xee \x1c=\x92\xf9&amp;\x8b\xbf\x7f\xf1^k[\x94\xd26C\xfe\x1fY16\xc8Q\x9f7`\xc1\xf8D_\xef\xbb$L&gt;R)\xef\xd7\xf5\r\x91\x17@\x8dZ\xa0\x81\x8a&lt;F+\x8d\xd5\n5/\x10\x0ed\xb4\xc1\xc0\xb8a\xe5\x81\x85&#125;\x0f2\x90\xa4\xaeg\xb7\xe8#\xe85h&quot;?\x90\x99\x7f\xe46\xf7y\xe1o\x1e5\xe6o\xda?!\xeb\xc2\x98\xcf\x98\xb0\x15\x01]E\xa5V\x032\xaa\x16\x83K*\xe3$\xcb\xfc\xe6\xb4\x8f\xa2\xa7\x900\x04G\xd8\x95\x98$\x9fN~\xb1\xa7\x0c\x8bGd\xa6\xa7\xe0F\xdd\xa2\xfbU\x9bE\xdc\x025\x1e\xfe\xc5v#\xb1Ft\xc1\x9c\x909\xd9\xb8\xe1h\xc1G*\x02c\xe5\xc7\x91q\x86/\xab\xfaS\xb9Tk\x90\xcc\x07\xb1\xa3E\x11e\x95fw\x02\xbfF\xb7j\x82\r\x92hD\x92\&#x27;FD\xb9\x9b\x0c\xc4%\xb6&gt;:\x1cZ \xc7\x1b\xa9\x15h[\xff?\x88\xcd\xbb\xe5\xf6\xb3\xb6B\xac\xda\xcd\xa7h\x81 \xcd\xeeu@\xef\x92!\xe2Vr+\x1d\xa6\x83Z\xdb\xb7\x1a\xd7#$)\xf1\x1f\x82\xdd\x80A\x94W\xf4\xa1\xe7J$\xda\x02\xd4\xb6\xe5\x84\xbegH\xb9\xc2\xe3\x82\xc5\xfd\xb1\xe7!\xeb\xe0\xd1J\x94\x04\x7f\x81\xee\xafn\xe3\x0e;\x17\xb6\x18\x9e;\xca\xb6`\x89\xd0\&#x27;\x87\xff\xcc \xf4yW#*j\x00ad\x9f.5/\xfc\tx1\xa6\xf7V.]\xfa\xec\xc9\x93\x87\x9a;\xb4\xe0\x0eC\x98&lt;5\x14a\xb1c\xaa\x91\x08O\xbaIz*Y\xf0\t\x8e\x96\x92\xa8\x0b\xeb\xa7\xdep\xa2zl\xd6_\x05%\x96\xda\x9e&quot;\x80\xeb\xf2bc\xfb\t\x1a\xe2h\xd1\x00tb|M\xf6\xd7\xc4.\xb5\xb1\xe3a\xa1\x96\x08\x9f\xa6:\xa8\xccouN^#fq\x03\xcan\x8cRJD6&amp;\n\xda\xe0T\xf5\x18\xfcp\xcd\x8f`\xdcS\x10\x00;\xd2\xb2\x14\xbd\xe4xa\x88v\x03p\x83\xdeL\xb0\xa0\xe8D\x04\xdd~\xa0\xacR\xc6 \xe0\x83t\xbf\xbf\x1d#\xc4`\xbe\xc6\xd7\xf9Z\x08\x88Tm\x81\xd6f*\xdc\x13\x0e\xc7\xae-\xadSmQ\x02y\xa4.\xbe\x8b\xf4\xe7\x9c\xbd\xdc5\xc3\x98&#123;Qw\xba\xeb\xf5\xc6jMy\xcaj\xd5\x01L8&lt;c\xf0k\xd6p\xe7\x1cz\xffW72\xd3&gt;Q\xe1\xab\xc3\x87tTW\xfdb\x88\x07Xu\xf8V\x92\x8e-\xffG\x80j\xd0/\x0e\xe1?W\x8f\xe7\xd2A\x80L\x19d\xce\xd0\xd4]\x00\x92\xde\xb9\xb3|\xda\x13mLQ_4\xbb1\xd3w\xa3f&amp;\xd4=\xd6~/=\x83U\xb6W\xc7\x95\x95\x05\xcb\xe3\xde\xc1\x15\xc9\x9bB\xce\tH\\z\xc1\xf3c\xc1v\xca\xbd\x06,\xea\n\x03\x1b\x12!C\xefj\x97\x96K\x07O\xa9\x98\xca\t\x1e\xd9\xc5\x98=\x9cq\x80\xd0\xba?`\x14\x91\x8c\xa9\xab\x83\\\xa6\xb5&gt;zq\xed\xc68\x0b\xba\xed\xda\xb2N\xfbI\xde\x8d\xb7\x1fu\xce\xf0[D\x9a\x8cW\xea\xd4\xebGz&#125;\x81\xd4\xf4\&#x27;N\\\xceW\x96:E\x06\xed\xd3\x06\xf8\x18d\x9e\x0edW\xdcb\xe1\xea\x1c+I\xf8\xdc\xd4\xda\\r~\x96\xb9?yd\xd9\xb7&#125;\xfb\x9ek\x85\xa84h\xf9\x8b\&#x27;(\xa9\xb4S\x87\xc7\x87\xa7\xf1\xdaIy\x95D\xfe\xe3\x90\xf0\x08\xf3\xfc\x00\x8e\x81\xc2k\xb8a3\xc1&#125;@\x8d\\\xf9T\xfc\xb0J\xeb\x8f\x99\xc9~\x95_\x14\xdde\x1c\xaf\xbeG\xd8\xdc\x99))\xb5\x8f\xdd\xdc\x06O~(\x0c\xa1\x1d\xa5c4\xf9=~Z\xc2\xea5G\xed\x10\x85S\x00~\x0c*\x14$\xcb\x0b\x08$0\x89\x1e\xd6Qq\x81\x18_\xb0\xc9o\x81,_\x9c\xcfi\xb7\x86\xf1\xbd\xa8\xa2N\x84@~\xaf.\x9f\x89\xbd/\xc3n\xcd\xf1\xc0\x83\xbaQ\xe1,\x9c6&quot;p]\xb5\xae\x835\xd1\xb6m\xe7M0&amp;q\xb3\x91S\xd0o\xdbF\xbc&lt;\x17&#123;eP6\xc3c\x7fR\x9a\xacWd3?\xb6joQ\x1d\xb2_\xc1\x9d`\xb8\x08!\x97\xc3z3Y_\xb8@\x88\xecc\r\xc1\xb7y\x80&#x27;</span><br>bits =<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(date2)):<br>    tmp = <span class="hljs-built_in">bin</span>(cipher2[:<span class="hljs-built_in">len</span>(date2)][i]^^date2[i])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)<br>    bits += tmp<br><br><span class="hljs-keyword">for</span> seed3 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>&lt;&lt;n2,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>    lfsr2 = lfsr(seed3,mask2,n2)<br>    output2 = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(date2)):<br>        tmp = lfsr2.getrandbit(<span class="hljs-number">8</span>)<br>        output2 += <span class="hljs-built_in">bin</span>(tmp)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>)<br>    output1 = <span class="hljs-built_in">int</span>(bits,<span class="hljs-number">2</span>)^^<span class="hljs-built_in">int</span>(output2,<span class="hljs-number">2</span>)<br>    output1 = <span class="hljs-built_in">bin</span>(output1)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">128</span>)<br>    seed1, mask1 = BM(output1,<span class="hljs-number">64</span>)<br>    <span class="hljs-keyword">if</span> seed1 == -<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> mask1 == -<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">continue</span><br>    lfsr1 = lfsr(seed1,mask1,n1)<br>    lfsr2 = lfsr(seed3,mask2,n2)<br>    flag = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cipher2:<br>        temp = i^^lfsr1.getrandbit(<span class="hljs-number">8</span>)^^lfsr2.getrandbit(<span class="hljs-number">8</span>)<br>        <span class="hljs-comment">#flag += libnum.n2s(int(temp))</span><br>        flag += <span class="hljs-built_in">chr</span>(temp)<br>    <span class="hljs-built_in">print</span>(seed3)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;SUSCTF&#x27;</span> <span class="hljs-keyword">in</span> flag <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;CTF&#x27;</span> <span class="hljs-keyword">in</span> flag <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;ctf&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">seed3 = 3054</span><br><span class="hljs-string">Date: 1984-12-25</span><br><span class="hljs-string">Though the hunger pangs were no longer so exquisite, he realized that he was weak.  He was compelled to pause for frequent rests, when he attacked the muskeg berries and rush-grass patches.  His tongue felt dry and large, as though covered with a fine hairy growth, and it tasted bitter in his mouth.  His heart gave him a great deal of trouble.  When he had travelled a few minutes it would begin a remorseless thump, thump, thump, and then leap up and away in a painful flutter of beats that choked him and made him go faint and dizzy.</span><br><span class="hljs-string">In the middle of the day he found two minnows in a large pool.  It was impossible to bale it, but he was calmer now and managed to catch them in his tin bucket.  They were no longer than his little finger, but he was not particularly hungry.  The dull ache in his stomach had been growing duller and fainter.  It seemed almost that his stomach was dozing.  He ate the fish raw, masticating with painstaking care, for the eating was an act of pure reason.  While he had no desire to eat, he knew that he must eat to live.</span><br><span class="hljs-string">In the evening he caught three more minnows, eating two and saving the third for breakfast.  The sun had dried stray shreds of moss, and he was able to warm himself with hot water.  He had not covered more than ten miles that day; and the next day, travelling whenever his heart permitted him, he covered no more than five miles.  But his stomach did not give him the slightest uneasiness.  It had gone to sleep.  He was in a strange country, too, and the caribou were growing more plentiful, also the wolves.  Often their yelps drifted across the desolation, and once he saw three of them slinking away before his path.</span><br><span class="hljs-string">The content is an excerpt from Love of Life, by Jack London. The problem is mainly about LFSR and I&#x27;ve tried not to make it hard (with the cost of some running time, actually). Your flag is SUSCTF&#123;Thx_f0r_y0uR_P4ti3nce_:)_GoodLuck!_1bc9b80142c24fef610b8d770b500009&#125; and I hope you will enjoy our game. You&#x27;ll find this problem so ez while solving other problems, which is created by --.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>



<hr>
<p>参考：</p>
<p>[SUSCTF2022_official_wp&#x2F;Ez_Pager_Tiper wp.md at main · susers&#x2F;SUSCTF2022_official_wp (github.com)](<a target="_blank" rel="noopener" href="https://github.com/susers/SUSCTF2022_official_wp/blob/main/crypto/Ez_Pager_Tiper/Ez_Pager_Tiper">https://github.com/susers/SUSCTF2022_official_wp/blob/main/crypto/Ez_Pager_Tiper/Ez_Pager_Tiper</a> wp.md)</p>
<p>[SUSCTF-Crypto方向所有赛题 - Love_DengFeng’s Blog](<a target="_blank" rel="noopener" href="https://love-deng-feng.top/2022/03/02/Writeup">https://love-deng-feng.top/2022/03/02/Writeup</a> of SUSCTF&#x2F;)</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Crypto/" class="category-chain-item">Crypto</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Crypto/">#Crypto</a>
      
        <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/">#流密码</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>SUSCTF - Ez_Pager_Tiper</div>
      <div>http://example.com/2022/06/28/CTF/Ez_Pager_Tiper/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>gla2xy</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年6月28日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/07/10/CTF/Dest0g3%20520%E8%BF%8E%E6%96%B0%E8%B5%9B/" title="Dest0g3 520迎新赛">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Dest0g3 520迎新赛</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/06/26/CTF/ACTF2022/" title="ACTF2022">
                        <span class="hidden-mobile">ACTF2022</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
