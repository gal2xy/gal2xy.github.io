

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="gla2xy">
  <meta name="keywords" content="">
  
    <meta name="description" content="新闻搜索抓包与字段解析新闻搜索请求如下 12345678910111213141516171819202122232425262728293031&amp;#123;  &quot;app&quot;: &quot;com.netease.newsreader.activity&quot;,  &quot;duration&quot;: &quot;782ms&quot;,  &quot;headers&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="某易新闻App逆向">
<meta property="og:url" content="http://example.com/2025/12/24/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98/%E7%BD%91%E6%98%93%E6%96%B0%E9%97%BBApp%E9%80%86%E5%90%91/index.html">
<meta property="og:site_name" content="gla2xy&#39;s blog">
<meta property="og:description" content="新闻搜索抓包与字段解析新闻搜索请求如下 12345678910111213141516171819202122232425262728293031&amp;#123;  &quot;app&quot;: &quot;com.netease.newsreader.activity&quot;,  &quot;duration&quot;: &quot;782ms&quot;,  &quot;headers&amp;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091715605.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091715649.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091715113.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091715461.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091716409.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091716277.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091716663.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091716892.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717572.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717550.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717218.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717216.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717805.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091718172.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091718052.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091719543.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091719712.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091719981.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720861.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720983.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720165.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720899.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720903.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721076.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721960.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721981.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721787.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721804.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722681.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722365.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722920.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722717.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722357.png">
<meta property="og:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722678.png">
<meta property="article:published_time" content="2025-12-24T12:16:25.000Z">
<meta property="article:modified_time" content="2026-02-10T08:29:18.297Z">
<meta property="article:author" content="gla2xy">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091715605.png">
  
  
  
  <title>某易新闻App逆向 - gla2xy&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"y4ByOj1FL3SFodYp7tlkfLna-gzGzoHsz","app_key":"7E1eIfDTBkJaMJkiQI0jToXE","server_url":null,"path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>gal2xy&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="某易新闻App逆向"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        gla2xy
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-12-24 20:16" pubdate>
          2025年12月24日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          21k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          178 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">某易新闻App逆向</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="新闻搜索抓包与字段解析"><a href="#新闻搜索抓包与字段解析" class="headerlink" title="新闻搜索抓包与字段解析"></a>新闻搜索抓包与字段解析</h1><p>新闻搜索请求如下</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;app&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;com.netease.newsreader.activity&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;duration&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;782ms&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;headers&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;Host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;gw.m.163.com&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-agent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;NewsApp/116.1 Android/10 (google/Pixel XL)&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;x-nr-trace-id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1766026470029_264453819_OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;x-nr-ise&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;x-xr-original-host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;gw.m.163.com&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-c&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;5pCc57Si&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-rc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;UjgzLZ+E4Lemnj+sMro9qwqQ3xlDp4PUECu18073DbE1QczpsTWV4NoxlU/51iL/OFnZkytSJ8NVUttJRaK4C+5QNhz9TLXVpP2VcqembRcentYAtzPoQ3SIVcMWWlm3PBbI53PX4Gd3tY1EgH3Np+rL+kbjQ1nSgTZVI2y8+C4=&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-d&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl/HSMGl&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-vd&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;YajLV6eMBiMvt5IKy6j+WFR1Ef3qFXuwpUC+xyv+n+Ax1J2VeRbbazQfmJ5LP9/v&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-appid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TItcOwjV9bndQ91C5VadYg==&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-sid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;iw0t412hC9bMZcnwa47jlPCtJAAGDbcAXKj7U7awjJM=&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-lc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;67NqtW9W02z/qXjaEOOHag==&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-n&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;VnE1Iqw3/SoXRqhFJu9cFg==&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;user-cn&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;8dabkxj70LEGQY+UurBODnjwStHTbMnr8pc6fFfTjog=&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;x-nr-ts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1766026470047&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;x-nr-sign&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;e042c3f8f8048430286cf510c479bb37&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;x-nr-net-lib&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;okhttp&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;accept-encoding&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;br,gzip&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;method&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;GET&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;protocol&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;h2&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;remoteIp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;36.99.227.75&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;remotePort&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">443</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;sessionId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;b7f8b1c5-529f-4467-b7a9-fd7a124d8198&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-12-18 10:54:30&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;url&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;https://gw.m.163.com/nc/api/v1/search/flow/comp?deviceId=R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl%2FHSMGl&amp;version=116.1&amp;channel=5pCc57Si&amp;canal=QQ_news_yunying4&amp;qId=&amp;tabname=&amp;ts=1766026469&amp;lat=&amp;lon=&amp;sign=QsadZvZNwAvCpeHCxMyeEt64vy1W9GW9JiAd9WEuyvl48ErR02zJ6%2FKXOnxX046I&amp;open=&amp;openpath=&amp;dtype=0&amp;start=MA%3D%3D&amp;limit=20&amp;q=54Gr566t&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>响应如下</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;成功&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;boxes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>            百度百科介绍以及用户推荐...<br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;tabList&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>            <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zonghe&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;综合&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zhannei&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;站内&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;shipin&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;视频&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;yonghu&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;用户&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;curtabname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zonghe&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;search_url&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;https://wp.m.163.com/163/html/frontend/newsapp-search-v1/index.html&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;tab_vertical&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;111&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;doc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;result&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>            	搜索结果<span class="hljs-punctuation">,</span> 根据score属性排名...    <br>            <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">586</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;pos&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-1</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;triggerTrustedSource&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;has_more&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;program&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;bjrec_search2v0e&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;nextCursorMark&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;sqtBC1oj+fjgXaqgR9V+1rYLCzSyGq5S2mDZlM/MM7Bjvfuh1fwiCgPeC4SIA5oj&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;qId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2539576465804824&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;tab_vertical_show&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1111&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;isGray&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;hideFeedback&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>



<h2 id="请求体字段解析"><a href="#请求体字段解析" class="headerlink" title="请求体字段解析"></a>请求体字段解析</h2><h3 id="请求头字段"><a href="#请求头字段" class="headerlink" title="请求头字段"></a>请求头字段</h3><table>
<thead>
<tr>
<th>字段</th>
<th align="left">值</th>
<th>注释</th>
</tr>
</thead>
<tbody><tr>
<td>Host</td>
<td align="left">gw.m.163.com</td>
<td>固定值</td>
</tr>
<tr>
<td>user-agent</td>
<td align="left">NewsApp&#x2F;116.1 Android&#x2F;10 (google&#x2F;Pixel XL)</td>
<td>用户设备信息</td>
</tr>
<tr>
<td>x-nr-trace-id</td>
<td align="left">1766026470029_264453819_OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM</td>
<td>毫秒级时间戳_8位随机数_设备标识</td>
</tr>
<tr>
<td>x-nr-ise</td>
<td align="left">0</td>
<td>固定值</td>
</tr>
<tr>
<td>x-xr-original-host</td>
<td align="left">gw.m.163.com</td>
<td>固定值</td>
</tr>
<tr>
<td>user-c</td>
<td align="left">5pCc57Si</td>
<td>8位随机值，与用户行为相关</td>
</tr>
<tr>
<td>user-rc</td>
<td align="left">UjgzLZ+E4Lemnj+sMro9qwqQ3xlDp4PUECu18073DbE1QczpsTWV4NoxlU&#x2F;51iL&#x2F;OFn<br />ZkytSJ8NVUttJRaK4C+5QNhz9TLXVpP2VcqembRcentYAtzPoQ3SIVcMWWlm3PBbI53<br />PX4Gd3tY1EgH3Np+rL+kbjQ1nSgTZVI2y8+C4&#x3D;</td>
<td>固定值，解码后是json</td>
</tr>
<tr>
<td>user-d</td>
<td align="left">R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl&#x2F;HSMGl</td>
<td>固定值，由设备标识加密得到</td>
</tr>
<tr>
<td>user-vd</td>
<td align="left">YajLV6eMBiMvt5IKy6j+WFR1Ef3qFXuwpUC+xyv+n+Ax1J2VeRbbazQfmJ5LP9&#x2F;v</td>
<td>固定值</td>
</tr>
<tr>
<td>user-appid</td>
<td align="left">TItcOwjV9bndQ91C5VadYg&#x3D;&#x3D;</td>
<td>固定值，由appid加密得到</td>
</tr>
<tr>
<td>user-sid</td>
<td align="left">iw0t412hC9bMZcnwa47jlPCtJAAGDbcAXKj7U7awjJM&#x3D;</td>
<td>同意会话中是固定值</td>
</tr>
<tr>
<td>user-lc</td>
<td align="left">67NqtW9W02z&#x2F;qXjaEOOHag&#x3D;&#x3D;</td>
<td>固定值，由行政区代码加密得到</td>
</tr>
<tr>
<td>user-n</td>
<td align="left">VnE1Iqw3&#x2F;SoXRqhFJu9cFg&#x3D;&#x3D;</td>
<td>由手机网络类型加密得到</td>
</tr>
<tr>
<td>user-cn</td>
<td align="left">8dabkxj70LEGQY+UurBODnjwStHTbMnr8pc6fFfTjog&#x3D;</td>
<td>固定值，由QQ_news_yunying4加密得到</td>
</tr>
<tr>
<td>x-nr-ts</td>
<td align="left">1766026470047</td>
<td>毫秒级时间戳</td>
</tr>
<tr>
<td>x-nr-sign</td>
<td align="left">e042c3f8f8048430286cf510c479bb37</td>
<td>当前请求的签名，由”设备标识+秒级时间戳“加密得到</td>
</tr>
<tr>
<td>x-nr-net-lib</td>
<td align="left">okhttp</td>
<td>使用的网络库（固定值）</td>
</tr>
<tr>
<td>accept-encoding</td>
<td align="left">br,gzip</td>
<td>固定值</td>
</tr>
<tr>
<td>sessionId</td>
<td align="left">b7f8b1c5-529f-4467-b7a9-fd7a124d8198</td>
<td>会话id，随机值</td>
</tr>
</tbody></table>
<h3 id="url参数字段"><a href="#url参数字段" class="headerlink" title="url参数字段"></a>url参数字段</h3><table>
<thead>
<tr>
<th>字段</th>
<th align="right">值</th>
<th>注释</th>
</tr>
</thead>
<tbody><tr>
<td>deviceId</td>
<td align="right">R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl&#x2F;HSMGl</td>
<td>与user-d字段的值相同</td>
</tr>
<tr>
<td>version</td>
<td align="right">116.1</td>
<td>app版本</td>
</tr>
<tr>
<td>channel</td>
<td align="right">5pCc57Si</td>
<td>与user-c字段相同</td>
</tr>
<tr>
<td>canal</td>
<td align="right">QQ_news_yunying4</td>
<td>固定值</td>
</tr>
<tr>
<td>qId</td>
<td align="right"></td>
<td>第一次为空，之后为响应中的qId字段值进行base64加密</td>
</tr>
<tr>
<td>tabname</td>
<td align="right"></td>
<td>第一次为空，之后为对应分类页面（zonghe, zhannei, shipin, yonghu）</td>
</tr>
<tr>
<td>ts</td>
<td align="right">1766026469</td>
<td>秒级时间戳</td>
</tr>
<tr>
<td>lat</td>
<td align="right"></td>
<td>纬度</td>
</tr>
<tr>
<td>lon</td>
<td align="right"></td>
<td>经度</td>
</tr>
<tr>
<td>sign</td>
<td align="right">QsadZvZNwAvCpeHCxMyeEt64vy1W9GW9JiAd9WEuyvl48ErR02zJ6&#x2F;KXOnxX046I</td>
<td>请求签名</td>
</tr>
<tr>
<td>open</td>
<td align="right"></td>
<td></td>
</tr>
<tr>
<td>openpath</td>
<td align="right"></td>
<td></td>
</tr>
<tr>
<td>dtype</td>
<td align="right">0</td>
<td>固定值</td>
</tr>
<tr>
<td>start</td>
<td align="right">MA&#x3D;&#x3D;</td>
<td>base64加密，第一次值为0，之后为响应中nextCursorMark的值</td>
</tr>
<tr>
<td>limit</td>
<td align="right">20</td>
<td>最多获取的新闻条数</td>
</tr>
<tr>
<td>q</td>
<td align="right">54Gr566t</td>
<td>搜索内容(base64加密)</td>
</tr>
</tbody></table>
<h1 id="参数生成逆向"><a href="#参数生成逆向" class="headerlink" title="参数生成逆向"></a>参数生成逆向</h1><p>**注意：很多参数都只生成一次，然后从缓冲中获取，因此很多参数的生成算法仅触发一次后不在触发，后续hook并不能捕获到信息。 **</p>
<h2 id="请求头参数"><a href="#请求头参数" class="headerlink" title="请求头参数"></a>请求头参数</h2><h3 id="x-nr-trace-id-x2F-X-NR-Trace-Id"><a href="#x-nr-trace-id-x2F-X-NR-Trace-Id" class="headerlink" title="x-nr-trace-id&#x2F;X-NR-Trace-Id"></a>x-nr-trace-id&#x2F;X-NR-Trace-Id</h3><p>jadx搜索该字段（区别大小写）</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091715605.png" srcset="/img/loading.gif" lazyload></p>
<p>hook 该函数后发现并没有触发！</p>
<p>我们可以换另一种方式定位，根据该参数值的格式，可以全局搜索 System.currentTimeMillis() + “_“，再根据是三个字段和两个”_“组合的，获取可疑函数如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091715649.png" srcset="/img/loading.gif" lazyload></p>
<p>hook 这两个函数后发现都触发了（<code>GalaxyRequest.c</code>触发多次，<code>util.getTraceId</code>触发一次）</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs routeros">GalaxyRequest.c is called: <span class="hljs-attribute">str</span>=82335006<br>GalaxyRequest.c <span class="hljs-attribute">result</span>=1766036199783_82335006_OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM<br>GalaxyRequest.c is called: <span class="hljs-attribute">str</span>=197139747<br>GalaxyRequest.c <span class="hljs-attribute">result</span>=1766036200700_197139747_OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM<br>GalaxyRequest.c is called: <span class="hljs-attribute">str</span>=251744591<br>GalaxyRequest.c <span class="hljs-attribute">result</span>=1766036202227_251744591_OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM<br>util.getTraceId is called: <span class="hljs-attribute">requestIdentity</span>=157192101<br>util.getTraceId <span class="hljs-attribute">result</span>=1766036202526_157192101_OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM<br>GalaxyRequest.c is called: <span class="hljs-attribute">str</span>=112736705<br>GalaxyRequest.c <span class="hljs-attribute">result</span>=1766036202745_112736705_OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM<br>GalaxyRequest.c is called: <span class="hljs-attribute">str</span>=79891345<br>GalaxyRequest.c <span class="hljs-attribute">result</span>=1766036203343_79891345_OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM<br></code></pre></td></tr></table></figure>

<p>同时hook和抓包，发现没有找到对应的值！？</p>
<p><code>Galaxy.N()</code>最终调用<code>Tools.B</code>方法</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091715113.png" srcset="/img/loading.gif" lazyload></p>
<p>这里是获取<code>SharedPreferences</code> 文件中的<code>galaxy_pre_key_device_id</code>的值，顾名思义就是标识设备的一串字符。</p>
<p>然而值得注意的是<code>util.getTraceId</code>最后一部分与<code>GalaxyRequest.c</code>最后一部分是相同的，且与我们的目标值一致，该方法如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091715461.png" srcset="/img/loading.gif" lazyload></p>
<p>通过<code>AdConfig.getDevice_id()</code>获取</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091716409.png" srcset="/img/loading.gif" lazyload></p>
<p>可以确认我们的目标值是<code>device_id</code>，具体生成方式见<code>DeviceInfo.getDevicesId()</code></p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091716277.png" srcset="/img/loading.gif" lazyload></p>
<p>通过<code>SharedPreferences</code>存储和获取”GALAXY_PRE_KEY_DEVICE_ID”键对应的值（进入<code>PrefHelper</code>可知），其他大部分逻辑是生成device_id。<code>SharedPreferences</code> 文件的名称如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">PREFERENCES_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ntesepaddata&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>具体文件路径为<code>/data/data/com.netease.newsreader.activity/shared_prefs/ntesepaddata</code>。</p>
<p>为了定该参数的生成位置，选择hook <code>System.currentTimeMillis</code>方法，同时进行抓包，通过请求包中改参数的毫秒级时间戳，最终打印堆栈如下</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus">System<span class="hljs-selector-class">.currentTimeMillis</span>: <span class="hljs-number">1766039948246</span><br>java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.Throwable</span><br>	at java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.System</span><span class="hljs-selector-class">.currentTimeMillis</span>(Native Method)<br>	at com<span class="hljs-selector-class">.netease</span><span class="hljs-selector-class">.newsreader</span><span class="hljs-selector-class">.common</span><span class="hljs-selector-class">.utils</span><span class="hljs-selector-class">.sys</span><span class="hljs-selector-class">.SystemUtilsWithCache</span><span class="hljs-selector-class">.d0</span>(SystemUtilsWithCache<span class="hljs-selector-class">.java</span>:<span class="hljs-number">5</span>)<br>	at com<span class="hljs-selector-class">.netease</span><span class="hljs-selector-class">.newsreader</span><span class="hljs-selector-class">.common</span><span class="hljs-selector-class">.net</span>.BaseHttpClient<span class="hljs-variable">$BuiltInInterceptor</span><span class="hljs-selector-class">.intercept</span>(BaseHttpClient<span class="hljs-selector-class">.java</span>:<span class="hljs-number">10</span>)<br>	at okhttp3<span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.http</span><span class="hljs-selector-class">.RealInterceptorChain</span><span class="hljs-selector-class">.c</span>(RealInterceptorChain<span class="hljs-selector-class">.kt</span>:<span class="hljs-number">12</span>)<br>	at okhttp3<span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.connection</span><span class="hljs-selector-class">.RealCall</span>.getResponseWithInterceptorChain<span class="hljs-variable">$okhttp</span>(RealCall<span class="hljs-selector-class">.kt</span>:<span class="hljs-number">16</span>)<br>	at okhttp3<span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.connection</span>.RealCall<span class="hljs-variable">$AsyncCall</span><span class="hljs-selector-class">.run</span>(RealCall<span class="hljs-selector-class">.kt</span>:<span class="hljs-number">6</span>)<br>	at java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.ThreadPoolExecutor</span><span class="hljs-selector-class">.runWorker</span>(ThreadPoolExecutor<span class="hljs-selector-class">.java</span>:<span class="hljs-number">1167</span>)<br>	at java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span>.ThreadPoolExecutor<span class="hljs-variable">$Worker</span><span class="hljs-selector-class">.run</span>(ThreadPoolExecutor<span class="hljs-selector-class">.java</span>:<span class="hljs-number">641</span>)<br>	at java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.Thread</span><span class="hljs-selector-class">.run</span>(Thread<span class="hljs-selector-class">.java</span>:<span class="hljs-number">919</span>)<br></code></pre></td></tr></table></figure>

<p><code>com.netease.newsreader.common.utils.sys.SystemUtilsWithCache.d0</code>函数如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091716663.png" srcset="/img/loading.gif" lazyload></p>
<p><code>com.netease.newsreader.common.net.BaseHttpClient$BuiltInInterceptor.intercept</code>函数如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091716892.png" srcset="/img/loading.gif" lazyload></p>
<p>可以确认的是，<code>x-nr-trace-id</code>和<code>X-NR-Trace-Id</code>对应的值都是相同的。中间值是对象的哈希值，也就是说参数<code>x-nr-trace-id</code>的中间字段是随机值，后者是device_id，对我们来说是固定值，前者是毫秒级时间戳。</p>
<h3 id="user-c-x2F-User-C"><a href="#user-c-x2F-User-C" class="headerlink" title="user-c&#x2F;User-C"></a>user-c&#x2F;User-C</h3><p>jadx搜索<code>user-c</code>，定位如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717572.png" srcset="/img/loading.gif" lazyload></p>
<p>对于第一个标注处，右键查找字段<code>f53186i</code>的用例，定位如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717550.png" srcset="/img/loading.gif" lazyload></p>
<p><code>c</code>方法如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717218.png" srcset="/img/loading.gif" lazyload></p>
<p>首先尝试获取现有的值，如果不存在，则通过<code>URLEncoder.encode(StringUtil.e(str, &quot;UTF-8&quot;), &quot;UTF-8&quot;);</code>获取，参数<code>str</code>就是<code>CommonGalaxy.o()</code>函数的返回值。</p>
<p>再来看第二个标注处</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717216.png" srcset="/img/loading.gif" lazyload></p>
<p>同样也是通过<code>URLEncoder.encode(StringUtil.e(o2, &quot;UTF-8&quot;), &quot;UTF-8&quot;);</code>获取，参数<code>o2</code>就是<code>CommonGalaxy.o()</code>函数的返回值。</p>
<p>查看<code>StringUtil.e()</code>方法</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091717805.png" srcset="/img/loading.gif" lazyload></p>
<p>是一个Base64Api，尝试将结果通过base64解码，得到值”搜索“。为了二次确认，hook 该函数，然而，实际逻辑并没有触发该函数！！！</p>
<p>那么选择hook <code>CommonGalaxy.o()</code>函数，手动搜索新闻，打印的全是”搜索“二字：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs stylus">CommonGalaxy<span class="hljs-selector-class">.o</span> result=搜索<br>CommonGalaxy<span class="hljs-selector-class">.o</span> is called<br>java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.Throwable</span><br>        at com<span class="hljs-selector-class">.netease</span><span class="hljs-selector-class">.newsreader</span><span class="hljs-selector-class">.common</span><span class="hljs-selector-class">.galaxy</span><span class="hljs-selector-class">.CommonGalaxy</span><span class="hljs-selector-class">.o</span>(Native Method)<br>        at com<span class="hljs-selector-class">.netease</span><span class="hljs-selector-class">.newsreader</span><span class="hljs-selector-class">.newarch</span><span class="hljs-selector-class">.base</span><span class="hljs-selector-class">.NewarchHttpUtils</span><span class="hljs-selector-class">.e</span>(NewarchHttpUtils<span class="hljs-selector-class">.java</span>:<span class="hljs-number">13</span>)<br>        at com<span class="hljs-selector-class">.netease</span><span class="hljs-selector-class">.newsreader</span><span class="hljs-selector-class">.base</span><span class="hljs-selector-class">.net</span><span class="hljs-selector-class">.client</span>.NewsHttpClient<span class="hljs-variable">$UserDataInterceptor</span><span class="hljs-selector-class">.intercept</span>(NewsHttpClient<span class="hljs-selector-class">.java</span>:<span class="hljs-number">3</span>)<br>        at okhttp3<span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.http</span><span class="hljs-selector-class">.RealInterceptorChain</span><span class="hljs-selector-class">.c</span>(RealInterceptorChain<span class="hljs-selector-class">.kt</span>:<span class="hljs-number">12</span>)<br>        at com<span class="hljs-selector-class">.netease</span><span class="hljs-selector-class">.newsreader</span><span class="hljs-selector-class">.common</span><span class="hljs-selector-class">.net</span><span class="hljs-selector-class">.sentry</span><span class="hljs-selector-class">.SentryInterceptor</span><span class="hljs-selector-class">.intercept</span>(SentryInterceptor<span class="hljs-selector-class">.java</span>:<span class="hljs-number">9</span>)<br>        at okhttp3<span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.http</span><span class="hljs-selector-class">.RealInterceptorChain</span><span class="hljs-selector-class">.c</span>(RealInterceptorChain<span class="hljs-selector-class">.kt</span>:<span class="hljs-number">12</span>)<br>        at com<span class="hljs-selector-class">.netease</span><span class="hljs-selector-class">.newsreader</span><span class="hljs-selector-class">.common</span><span class="hljs-selector-class">.net</span><span class="hljs-selector-class">.interceptor</span><span class="hljs-selector-class">.HostOptimizeInterceptor</span><span class="hljs-selector-class">.intercept</span>(HostOptimizeInterceptor<span class="hljs-selector-class">.java</span>:<span class="hljs-number">6</span>)<br>        at okhttp3<span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.http</span><span class="hljs-selector-class">.RealInterceptorChain</span><span class="hljs-selector-class">.c</span>(RealInterceptorChain<span class="hljs-selector-class">.kt</span>:<span class="hljs-number">12</span>)<br>        at com<span class="hljs-selector-class">.netease</span><span class="hljs-selector-class">.newsreader</span><span class="hljs-selector-class">.common</span><span class="hljs-selector-class">.net</span>.BaseHttpClient<span class="hljs-variable">$BuiltInInterceptor</span><span class="hljs-selector-class">.intercept</span>(BaseHttpClient<span class="hljs-selector-class">.java</span>:<span class="hljs-number">16</span>)<br>        at okhttp3<span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.http</span><span class="hljs-selector-class">.RealInterceptorChain</span><span class="hljs-selector-class">.c</span>(RealInterceptorChain<span class="hljs-selector-class">.kt</span>:<span class="hljs-number">12</span>)<br>        at okhttp3<span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.connection</span><span class="hljs-selector-class">.RealCall</span>.getResponseWithInterceptorChain<span class="hljs-variable">$okhttp</span>(RealCall<span class="hljs-selector-class">.kt</span>:<span class="hljs-number">16</span>)<br>        at okhttp3<span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.connection</span>.RealCall<span class="hljs-variable">$AsyncCall</span><span class="hljs-selector-class">.run</span>(RealCall<span class="hljs-selector-class">.kt</span>:<span class="hljs-number">6</span>)<br>        at java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.ThreadPoolExecutor</span><span class="hljs-selector-class">.runWorker</span>(ThreadPoolExecutor<span class="hljs-selector-class">.java</span>:<span class="hljs-number">1167</span>)<br>        at java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span>.ThreadPoolExecutor<span class="hljs-variable">$Worker</span><span class="hljs-selector-class">.run</span>(ThreadPoolExecutor<span class="hljs-selector-class">.java</span>:<span class="hljs-number">641</span>)<br>        at java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.Thread</span><span class="hljs-selector-class">.run</span>(Thread<span class="hljs-selector-class">.java</span>:<span class="hljs-number">919</span>)<br>...同上...<br></code></pre></td></tr></table></figure>

<p>通过上面的堆栈函数可以知道，是执行了<code>NewarchHttpUtils.e</code>方法的，里面的<code>c</code>方法确实有<code>StringUtil.e</code>方法，但是<code>c</code>方法中调用<code>StringUtil.e</code>方法的前提是该值不存在！所以这就解释的通了。</p>
<p>另外我将<code>https://gw.m.163.com/nc/api/v1/search/hot-word</code>中的<code>user-c</code>参数也进行了base64解码</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;user-c&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;5aS05p2h&quot;</span><br></code></pre></td></tr></table></figure>

<p>结果是”头条“二字。</p>
<p>综上，已经可以肯定了<code>user-c</code>参数的生成是根据“访问不同资源&#x2F;页面的关键字”而生成的，并且只是简单的将明文进行了base64加密。</p>
<h3 id="user-n-x2F-User-N"><a href="#user-n-x2F-User-N" class="headerlink" title="user-n&#x2F;User-N"></a>user-n&#x2F;User-N</h3><p>定位同<code>user-c</code>一样，两种方法都可行，同样也在相同位置处。通过字段查找用例定位如下</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">a</span>(hashMap, f53185h, <span class="hljs-built_in">g</span>());<br></code></pre></td></tr></table></figure>

<p>a方法区别于b方法如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091718172.png" srcset="/img/loading.gif" lazyload></p>
<p>a方法会对值进行加密，而b方法则没有。</p>
<p>g方法最终调用<code>NetUtil.i()</code>，该方法如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091718052.png" srcset="/img/loading.gif" lazyload></p>
<p>该方法主要是获取网络状态，其中<code>networkInfo.getSubtypeName()</code>获取的是移动网络子类型名称，常见值如下</p>
<table>
<thead>
<tr>
<th>网络</th>
<th><code>getSubtype()</code></th>
<th><code>getSubtypeName()</code></th>
</tr>
</thead>
<tbody><tr>
<td>2G</td>
<td>NETWORK_TYPE_GPRS</td>
<td><code>&quot;GPRS&quot;</code></td>
</tr>
<tr>
<td>2G</td>
<td>EDGE</td>
<td><code>&quot;EDGE&quot;</code></td>
</tr>
<tr>
<td>3G</td>
<td>UMTS</td>
<td><code>&quot;UMTS&quot;</code></td>
</tr>
<tr>
<td>3G</td>
<td>HSDPA</td>
<td><code>&quot;HSDPA&quot;</code></td>
</tr>
<tr>
<td>3G</td>
<td>HSPA</td>
<td><code>&quot;HSPA&quot;</code></td>
</tr>
<tr>
<td>4G</td>
<td>LTE</td>
<td><code>&quot;LTE&quot;</code></td>
</tr>
<tr>
<td>4G+</td>
<td>LTE_CA</td>
<td><code>&quot;LTE_CA&quot;</code></td>
</tr>
<tr>
<td>5G</td>
<td>NR</td>
<td><code>&quot;NR&quot;</code></td>
</tr>
</tbody></table>
<p>再来看看加密方法<code>Encrypt.getEncryptedParams</code>方法</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091719543.png" srcset="/img/loading.gif" lazyload></p>
<p>在<code>getEncryptedParams</code>方法中尝试获取现有值，获取不到则调用<code>getEncryptedParamsInner</code>方法生成，在该方法中，主要是将<code>callEncrypt(Core.context(), str, i2)</code>的返回值进行base64加密。具体来看看该方法</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091719712.png" srcset="/img/loading.gif" lazyload></p>
<p>最终调用native方法，加载的库是<code>librandom.so</code>。IDA加载该库后，搜索<code>Java_com_netease_nr_biz_pc_sync_Encrypt_encrypt</code>即可定位到对应方法。重命名第一个参数（<code>JNIEnv</code>指针）和第二个参数（静态方法对应<code>jclass</code>或实例方法对应<code>jobject</code>对象）。</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091719981.png" srcset="/img/loading.gif" lazyload></p>
<p>首先执行<code>getRandomKey</code>方法获取<code>RandomKey</code>，该方法如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720861.png" srcset="/img/loading.gif" lazyload></p>
<p>主要通过<code>i2</code>的值选择不同的随机字符串作为密钥。根据<code>i2=0</code>，可以确认随机字符串为</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">neteasenewsboard</span>	(hex:<span class="hljs-number">6</span>E <span class="hljs-number">65</span> <span class="hljs-number">74</span> <span class="hljs-number">65</span> <span class="hljs-number">61</span> <span class="hljs-number">73</span> <span class="hljs-number">65</span> <span class="hljs-number">6</span>E <span class="hljs-number">65</span> <span class="hljs-number">77</span> <span class="hljs-number">73</span> <span class="hljs-number">62</span> <span class="hljs-number">6</span>F <span class="hljs-number">61</span> <span class="hljs-number">72</span> <span class="hljs-number">64</span>)<br></code></pre></td></tr></table></figure>

<p>然后执行<code>doEn</code>方法，该方法如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720983.png" srcset="/img/loading.gif" lazyload></p>
<p>加密逻辑主要是通过反射获取Java层的加密库进行<code>AES/ECB/PKCS7Padding</code>加密。解密如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720165.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="user-d-x2F-User-D"><a href="#user-d-x2F-User-D" class="headerlink" title="user-d&#x2F;User-D"></a>user-d&#x2F;User-D</h3><p>明文通过<code>SystemUtilsWithCache.s()</code>方法获取</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720899.png" srcset="/img/loading.gif" lazyload></p>
<p>返回值是<code>device_id</code>，就是<code>x-nr-trace-id</code>的最后一部分。</p>
<p>加密方法同<code>user-n</code>一致，解密得到的就是<code>device_id</code>。</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091720903.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="user-rc-x2F-User-Rc"><a href="#user-rc-x2F-User-Rc" class="headerlink" title="user-rc&#x2F;User-Rc"></a>user-rc&#x2F;User-Rc</h3><p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721076.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="user-xxx系列"><a href="#user-xxx系列" class="headerlink" title="user-xxx系列"></a>user-xxx系列</h3><table>
<thead>
<tr>
<th>字段</th>
<th>初始值</th>
<th>还原后的值</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>user-d</td>
<td>R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl&#x2F;HSMGl</td>
<td>OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM</td>
<td>device_id，进一步base64解码得到9b0d317068740eca__google_Pixel XL</td>
</tr>
<tr>
<td>user-vd</td>
<td>YajLV6eMBiMvt5IKy6j+WFR1Ef3qFXuwpUC+xyv+n+Ax1J2VeRbbazQfmJ5LP9&#x2F;v</td>
<td>MTc2NjAyNjA0OTQ3M18xOTI0NjE1NTVfaUkybkN3bng%3D</td>
<td>进一步base64解码得到1766026049473_192461555_iI2nCwnx，可能与App安装、启动等相关</td>
</tr>
<tr>
<td>user-appid</td>
<td>TItcOwjV9bndQ91C5VadYg&#x3D;&#x3D;</td>
<td>2x1kfBk63z</td>
<td></td>
</tr>
<tr>
<td>user-sid</td>
<td>iw0t412hC9bMZcnwa47jlPCtJAAGDbcAXKj7U7awjJM&#x3D;</td>
<td>dbhggi1766026422530（6个字符+毫秒级时间戳）</td>
<td>sessionID加密</td>
</tr>
<tr>
<td>user-lc</td>
<td>67NqtW9W02z&#x2F;qXjaEOOHag&#x3D;&#x3D;</td>
<td>110000</td>
<td>行政区划代码</td>
</tr>
<tr>
<td>user-n</td>
<td>VnE1Iqw3&#x2F;SoXRqhFJu9cFg&#x3D;&#x3D;</td>
<td>WIFI</td>
<td>手机网络类型</td>
</tr>
<tr>
<td>user-cn</td>
<td>8dabkxj70LEGQY+UurBODnjwStHTbMnr8pc6fFfTjog&#x3D;</td>
<td>QQ_news_yunying4</td>
<td>channel_id</td>
</tr>
</tbody></table>
<h3 id="x-nr-sign"><a href="#x-nr-sign" class="headerlink" title="x-nr-sign"></a>x-nr-sign</h3><p>jadx全局搜索该字符串，唯一定位到声明处，右键查找用例</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721960.png" srcset="/img/loading.gif" lazyload></p>
<p>显然第二处才是可能赋值的地方。</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721981.png" srcset="/img/loading.gif" lazyload></p>
<p><code>l</code>方法应该是个键值添加的地方，<code>x-nr-sign</code>值通过<code>a(query, currentTimeMillis)</code>生成，</p>
<p><code>query</code>则是通过<code>HttpUrl.query()</code>方法获取，该方法如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721787.png" srcset="/img/loading.gif" lazyload></p>
<p><code>f83693g</code>是<code>List&lt;String&gt;</code>类型，根据函数名可以猜测是将url参数转字符串，通过hook 该方法也可以确认。</p>
<p>来看<code>a</code>方法</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091721804.png" srcset="/img/loading.gif" lazyload></p>
<p>进一步调用<code>StringUtils.n</code>方法，参数为：<code>query参数 + &quot;gNlVGcSKf5&quot; + 毫秒级时间戳</code>。</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722681.png" srcset="/img/loading.gif" lazyload></p>
<p>该部分主要是通过<code>g</code>方法（<code>getBytes()</code>方法）将参数转成字节数组，进行md5加密，然后md5结果作为参数调用<code>a</code>方法。</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722365.png" srcset="/img/loading.gif" lazyload></p>
<p><code>f52113a</code>和<code>f52114b</code>都是16进制字符数组，区别在于前者是小写后者是大写，根据参数<code>z2=false</code>可知选择小写。这部分说是加密，其实就是将md5小写化或者大写化（根据<code>z2</code>决定）。</p>
<p>Frida hook <code>query</code>和 <code>a</code>方法，代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<br>        <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; <br>            <span class="hljs-keyword">let</span> <span class="hljs-title class_">HttpUrl</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;okhttp3.HttpUrl&quot;</span>);<br>            <span class="hljs-title class_">HttpUrl</span>[<span class="hljs-string">&quot;query&quot;</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`HttpUrl.query is called`</span>);<br>                <span class="hljs-keyword">var</span> f83693g = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;_g&quot;</span>].<span class="hljs-property">value</span>;<br>                <span class="hljs-keyword">if</span> (f83693g !== <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`HttpUrl._g: <span class="hljs-subst">$&#123;Java.use(<span class="hljs-string">&quot;java.util.ArrayList&quot;</span>).$new(f83693g).toString()&#125;</span>`</span>);<br>                &#125;<br>                <span class="hljs-keyword">let</span> result = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;query&quot;</span>]();<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`HttpUrl.query result: <span class="hljs-subst">$&#123;result&#125;</span>`</span>);<br>                <span class="hljs-keyword">return</span> result;<br>            &#125;;<br><br>            <span class="hljs-keyword">let</span> <span class="hljs-title class_">RequestSignInterceptor</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.netease.newsreader.common.net.interceptor.RequestSignInterceptor&quot;</span>);<br>            <span class="hljs-title class_">RequestSignInterceptor</span>[<span class="hljs-string">&quot;a&quot;</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">str, j2</span>) &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`RequestSignInterceptor.a is called: str: <span class="hljs-subst">$&#123;str&#125;</span>, j2: <span class="hljs-subst">$&#123;j2&#125;</span>`</span>);<br>                <span class="hljs-keyword">let</span> result = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;a&quot;</span>](str, j2);<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`RequestSignInterceptor.a result: <span class="hljs-subst">$&#123;result&#125;</span>`</span>);<br>                <span class="hljs-keyword">return</span> result;<br>            &#125;;<br>        &#125;<br>    );<br>&#125;<br></code></pre></td></tr></table></figure>

<p>再结合抓包可以确认<code>x-nr-sign</code>参数生成部分如下</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dts">HttpUrl.query is called<br>HttpUrl._g: [deviceId, R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl/HSMGl, version, <span class="hljs-number">116.1</span>, channel, <span class="hljs-number">5</span>pCc57Si, canal, QQ_news_yunying4, qId, OTEzMzAzNTc3MTMwNTE5, tabname, , ts, <span class="hljs-number">1766121716</span>, lat, , lon, , sign, <span class="hljs-number">4</span>w5LCmZUAXCNfX2GsDH7Cf2tDyi2gMCymYF+Vi33mN548ErR02zJ6/KXOnxX046I, open, , openpath, , dtype, <span class="hljs-number">0</span>, start, MA==, limit, <span class="hljs-number">20</span>, q, <span class="hljs-number">57u</span>d5a+<span class="hljs-number">56</span>Zu25bqm]<br>HttpUrl.query result: deviceId=R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl/HSMGl<span class="hljs-variable">&amp;version</span>=<span class="hljs-number">116.1</span><span class="hljs-variable">&amp;channel</span>=<span class="hljs-number">5</span>pCc57Si<span class="hljs-variable">&amp;canal</span>=QQ_news_yunying4<span class="hljs-variable">&amp;</span>qId=OTEzMzAzNTc3MTMwNTE5<span class="hljs-variable">&amp;tabname</span>=<span class="hljs-variable">&amp;ts</span>=<span class="hljs-number">1766121716</span><span class="hljs-variable">&amp;lat</span>=<span class="hljs-variable">&amp;lon</span>=<span class="hljs-variable">&amp;sign</span>=<span class="hljs-number">4</span>w5LCmZUAXCNfX2GsDH7Cf2tDyi2gMCymYF+Vi33mN548ErR02zJ6/KXOnxX046I<span class="hljs-variable">&amp;open</span>=<span class="hljs-variable">&amp;openpath</span>=<span class="hljs-variable">&amp;dtype</span>=<span class="hljs-number">0</span><span class="hljs-variable">&amp;start</span>=MA==<span class="hljs-variable">&amp;limit</span>=<span class="hljs-number">20</span><span class="hljs-variable">&amp;q</span>=<span class="hljs-number">57u</span>d5a+<span class="hljs-number">56</span>Zu25bqm<br>RequestSignInterceptor.a is called: str: deviceId=R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl/HSMGl<span class="hljs-variable">&amp;version</span>=<span class="hljs-number">116.1</span><span class="hljs-variable">&amp;channel</span>=<span class="hljs-number">5</span>pCc57Si<span class="hljs-variable">&amp;canal</span>=QQ_news_yunying4<span class="hljs-variable">&amp;</span>qId=OTEzMzAzNTc3MTMwNTE5<span class="hljs-variable">&amp;tabname</span>=<span class="hljs-variable">&amp;ts</span>=<span class="hljs-number">1766121716</span><span class="hljs-variable">&amp;lat</span>=<span class="hljs-variable">&amp;lon</span>=<span class="hljs-variable">&amp;sign</span>=<span class="hljs-number">4</span>w5LCmZUAXCNfX2GsDH7Cf2tDyi2gMCymYF+Vi33mN548ErR02zJ6/KXOnxX046I<span class="hljs-variable">&amp;open</span>=<span class="hljs-variable">&amp;openpath</span>=<span class="hljs-variable">&amp;dtype</span>=<span class="hljs-number">0</span><span class="hljs-variable">&amp;start</span>=MA==<span class="hljs-variable">&amp;limit</span>=<span class="hljs-number">20</span><span class="hljs-variable">&amp;q</span>=<span class="hljs-number">57u</span>d5a+<span class="hljs-number">56</span>Zu25bqm, j2: <span class="hljs-number">1766121716635</span><br>RequestSignInterceptor.a result: <span class="hljs-number">3e53</span>cc88982ae5d775adbcc07599ec8d<br></code></pre></td></tr></table></figure>

<p>最终可以确认<code>x-nr-sign</code>参数生成过程为：**md5(URL参数字符串 + “gNlVGcSKf5” + 毫秒级时间戳)**。</p>
<h2 id="URL参数"><a href="#URL参数" class="headerlink" title="URL参数"></a>URL参数</h2><h3 id="sign"><a href="#sign" class="headerlink" title="sign"></a>sign</h3><p>jadx全局搜索<code>”flow/comp&quot;</code></p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722920.png" srcset="/img/loading.gif" lazyload></p>
<p>并判断是第二处，代码如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722717.png" srcset="/img/loading.gif" lazyload></p>
<p>搜索<code>f43446c</code>用例，定位代码如下</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722357.png" srcset="/img/loading.gif" lazyload></p>
<p>这里是URL组装，里面的<code>UserReward.f42460J</code>即为目标值<code>sign</code>，与<code>deviceId</code>值生成相比，不同的地方是获取device_id+秒级时间戳，调用<code>StringUtils.n()</code>进行md5加密</p>
<p><img src="https://raw.githubusercontent.com/gal2xy/blog_img/main/img/202602091722678.png" srcset="/img/loading.gif" lazyload></p>
<p>最后都是<code>AES/ECB/PKCS7Padding</code>加密再base64加密。</p>
<h3 id="user-sid"><a href="#user-sid" class="headerlink" title="user-sid"></a>user-sid</h3><p>jadx搜索不到，但通过抓包可以发现</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>在搜索结果展示页面往下滑，触发更多请求<br>wKtraxGUri0o2WvFr1f1trY48uFm1UfUst8IJ9NXdFg=<br>wKtraxGUri0o2WvFr1f1trY48uFm1UfUst8IJ9NXdFg=<br><span class="hljs-regexp">//</span>与上述不同会话的请求<br>iw0t412hC9bMZcnwa47jlPCtJAAGDbcAXKj7U7awjJM=<br><span class="hljs-number">3</span>smlZlQvTuyjzD6RUzrQBnn+ItIQn+cpmZB7ehGoIZg=<br></code></pre></td></tr></table></figure>

<p>结合名字可以确认是会话级别参数，在同一会话中保持固定值。这些值通过同<code>user-n</code>的解密过程得到</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns">aagiga<span class="hljs-number">1766122722452</span><br>dbhggi17<span class="hljs-number">66026422530</span><br>fdbgda<span class="hljs-number">1766133429518</span><br></code></pre></td></tr></table></figure>

<p>可以确定明文是由”6个随机小写字母+毫秒级时间戳”组成，然后先后通过<code>AES/ECB/PKCS7Padding</code>加密和<code>base64</code>加密得到<code>user-sid</code>。</p>
<h3 id="qId-x2F-start"><a href="#qId-x2F-start" class="headerlink" title="qId&#x2F;start"></a>qId&#x2F;start</h3><p>同样还是在搜索结果展示页面往下滑，触发更多请求。</p>
<p>可以发现响应包中存在如下字段</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;nextCursorMark&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;EUp6sZc6vOpW8qCe5ak2sfVkg0ziiOg29UyOGG9+AfnN2x7NHdzUOXnTxju3ZcVD&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;qId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;7051912003775192&quot;</span><br></code></pre></td></tr></table></figure>

<p>结合之后的请求URL</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs json">https<span class="hljs-punctuation">:</span><span class="hljs-comment">//gw.m.163.com/nc/api/v1/search/flow/comp?</span><br>deviceId=R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl%<span class="hljs-number">2</span>FHSMGl<br>version=<span class="hljs-number">116.1</span><br>channel=<span class="hljs-number">5</span>pCc57Si<br>canal=QQ_news_yunying4<br>qId=NzA1MTkxMjAwMzc3NTE5Mg%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D<br>tabname=zonghe<br>ts=<span class="hljs-number">1766122748</span><br>lat=<br>lon=<br>sign=eQOXxTy7Dk8ANH5HvzniLBiX%<span class="hljs-number">2</span>Fvh070Nb2LYh8lZn3H148ErR02zJ6%<span class="hljs-number">2</span>FKXOnxX046I<br>open=<br>openpath=<br>dtype=<span class="hljs-number">0</span><br>start=RVVwNnNaYzZ2T3BXOHFDZTVhazJzZlZrZzB6aWlPZzI5VXlPR0c5K0Fmbk4yeDdOSGR6VU9YblR4anUzWmNWRA%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D<br>limit=<span class="hljs-number">20</span><br>q=<span class="hljs-number">54</span>Gr566t<br></code></pre></td></tr></table></figure>

<p>将其中<code>qId</code>进行base64解码就是上一次响应包中的<code>qId</code>的值。</p>
<p>将<code>start</code>进行base64解码就是上一次响应包中的<code>nextCursorMark</code>的值。</p>
<h1 id="请求脚本"><a href="#请求脚本" class="headerlink" title="请求脚本"></a>请求脚本</h1><p>循环请求脚本如下，可持续搜索同一关键字的相关新闻。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode, b64decode<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlencode<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> ascii_lowercase<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">AESEncrypt</span>(<span class="hljs-params">plain: <span class="hljs-built_in">str</span>, key: <span class="hljs-built_in">str</span>, mode=AES.MODE_ECB</span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    plain_bytes = plain.encode(<span class="hljs-string">&quot;UTF-8&quot;</span>)<br>    key_bytes = key.encode(<span class="hljs-string">&quot;UTF-8&quot;</span>)<br><br>    ase = AES.new(key_bytes, mode)<br><br>    <span class="hljs-comment"># PKCS7Padding</span><br>    padded_data = pad(plain_bytes, AES.block_size)<br><br>    cipher = ase.encrypt(padded_data)<br><br>    <span class="hljs-keyword">return</span> cipher<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base64Encode</span>(<span class="hljs-params">plain</span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(plain) != <span class="hljs-built_in">bytes</span>:<br>        plain = plain.encode()<br>    <span class="hljs-keyword">return</span> b64encode(plain).decode()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">constructReqParams</span>(<span class="hljs-params">qId, tabName, sign, start, queryWord</span>):<br>    reqParams = &#123;<br>        <span class="hljs-string">&quot;deviceId&quot;</span>: <span class="hljs-string">&quot;R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl/HSMGl&quot;</span>,<br>        <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-number">116.1</span>,<br>        <span class="hljs-string">&quot;channel&quot;</span>: <span class="hljs-string">&quot;5pCc57Si&quot;</span>,  <span class="hljs-comment"># b64encode(&quot;搜索&quot;.encode(&quot;UTF-8&quot;))</span><br>        <span class="hljs-string">&quot;canal&quot;</span>: <span class="hljs-string">&quot;QQ_news_yunying4&quot;</span>,<br>        <span class="hljs-string">&quot;qId&quot;</span>: qId,<br>        <span class="hljs-string">&quot;tabname&quot;</span>: tabName,<br>        <span class="hljs-string">&quot;ts&quot;</span>: <span class="hljs-built_in">int</span>(time.time()),<br>        <span class="hljs-string">&quot;lat&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;lon&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;sign&quot;</span>: sign,<br>        <span class="hljs-string">&quot;open&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;openpath&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;dtype&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;start&quot;</span>: start,<br>        <span class="hljs-string">&quot;limit&quot;</span>: <span class="hljs-number">20</span>,<br>        <span class="hljs-string">&quot;q&quot;</span>: queryWord<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> reqParams<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">constructReqHeaders</span>(<span class="hljs-params">xNrTraceId, xNrSign, userSid</span>):<br>    reqHeaders = &#123;<br>        <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;gw.m.163.com&quot;</span>,<br>        <span class="hljs-string">&quot;user-agent&quot;</span>: <span class="hljs-string">&quot;NewsApp/116.1 Android/10 (google/Pixel XL)&quot;</span>,<br>        <span class="hljs-string">&quot;x-nr-trace-id&quot;</span>: xNrTraceId,<br>        <span class="hljs-string">&quot;x-nr-ise&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>        <span class="hljs-string">&quot;x-xr-original-host&quot;</span>: <span class="hljs-string">&quot;gw.m.163.com&quot;</span>,<br>        <span class="hljs-string">&quot;user-c&quot;</span>: <span class="hljs-string">&quot;5pCc57Si&quot;</span>,  <span class="hljs-comment"># 固定值 b64encode(&quot;搜索&quot;.encode(&quot;UTF-8&quot;))</span><br>        <span class="hljs-string">&quot;user-rc&quot;</span>: <span class="hljs-string">&quot;UjgzLZ+E4Lemnj+sMro9qwqQ3xlDp4PUECu18073DbE1QczpsTWV4NoxlU/51iL/OFnZkytSJ8NVUttJRaK4C+5QNhz9TLXVpP2VcqembRcentYAtzPoQ3SIVcMWWlm3PBbI53PX4Gd3tY1EgH3Np+rL+kbjQ1nSgTZVI2y8+C4\u003d&quot;</span>, <span class="hljs-comment">#固定值</span><br>        <span class="hljs-string">&quot;user-d&quot;</span>: <span class="hljs-string">&quot;R5UTRhOqUODMPloPL2CjBANkzPltnVQlhjKXCEeQMqkMVHVe2Gn4XG4lUl/HSMGl&quot;</span>,   <span class="hljs-comment"># 固定值</span><br>        <span class="hljs-string">&quot;user-vd&quot;</span>: <span class="hljs-string">&quot;YajLV6eMBiMvt5IKy6j+WFR1Ef3qFXuwpUC+xyv+n+Ax1J2VeRbbazQfmJ5LP9/v&quot;</span>,  <span class="hljs-comment"># 固定值</span><br>        <span class="hljs-string">&quot;user-appid&quot;</span>: <span class="hljs-string">&quot;TItcOwjV9bndQ91C5VadYg\u003d\u003d&quot;</span>,         <span class="hljs-comment"># 固定值</span><br>        <span class="hljs-string">&quot;user-sid&quot;</span>: userSid,    <span class="hljs-comment"># 每次会话是固定的</span><br>        <span class="hljs-string">&quot;user-lc&quot;</span>: <span class="hljs-string">&quot;67NqtW9W02z/qXjaEOOHag\u003d\u003d&quot;</span>,        <span class="hljs-comment"># 行政区代码，可固定</span><br>        <span class="hljs-string">&quot;user-n&quot;</span>: <span class="hljs-string">&quot;VnE1Iqw3/SoXRqhFJu9cFg\u003d\u003d&quot;</span>,         <span class="hljs-comment"># 网络状态，可固定</span><br>        <span class="hljs-string">&quot;user-cn&quot;</span>: <span class="hljs-string">&quot;8dabkxj70LEGQY+UurBODnjwStHTbMnr8pc6fFfTjog\u003d&quot;</span>,     <span class="hljs-comment"># 固定值</span><br>        <span class="hljs-string">&quot;x-nr-ts&quot;</span>: <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)),<br>        <span class="hljs-string">&quot;x-nr-sign&quot;</span>: xNrSign,<br>        <span class="hljs-string">&quot;x-nr-net-lib&quot;</span>: <span class="hljs-string">&quot;okhttp&quot;</span>,<br>        <span class="hljs-string">&quot;accept-encoding&quot;</span>: <span class="hljs-string">&quot;br,gzip&quot;</span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> reqHeaders<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hashCode</span>():<br>    <span class="hljs-built_in">max</span> = <span class="hljs-number">0x400000</span><br>    <span class="hljs-keyword">return</span> random.randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">max</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generateXNrTraceId</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)) + <span class="hljs-string">&quot;_&quot;</span> + <span class="hljs-built_in">str</span>(hashCode()) + <span class="hljs-string">&quot;_&quot;</span> + <span class="hljs-string">&quot;OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generateXNrSign</span>(<span class="hljs-params">url</span>):<br>    plain = url + <span class="hljs-string">&quot;gNlVGcSKf5&quot;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>))<br>    XNrSign = hashlib.md5(plain.encode(<span class="hljs-string">&quot;UTF-8&quot;</span>)).hexdigest()<br>    <span class="hljs-keyword">return</span> XNrSign<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generateSign</span>():<br>    plain = <span class="hljs-string">&quot;OWIwZDMxNzA2ODc0MGVjYV9fZ29vZ2xlX1BpeGVsIFhM&quot;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time()))<br>    md5Result = hashlib.md5(plain.encode(<span class="hljs-string">&quot;UTF-8&quot;</span>)).hexdigest()<br>    sign = base64Encode(AESEncrypt(md5Result, <span class="hljs-string">&quot;neteasenewsboard&quot;</span>))<br><br>    <span class="hljs-keyword">return</span> sign<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generateUserSid</span>():<br>    plain = <span class="hljs-string">&quot;&quot;</span>.join(random.choice(ascii_lowercase) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>)) + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>))<br>    userSid = base64Encode(AESEncrypt(plain,<span class="hljs-string">&quot;neteasenewsboard&quot;</span>))<br>    <span class="hljs-keyword">return</span> userSid<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">constructRequest</span>(<span class="hljs-params">queryWord, tabeName, nextCursorMark, qId, userSid</span>):<br><br>    url = <span class="hljs-string">&quot;https://gw.m.163.com/nc/api/v1/search/flow/comp&quot;</span><br>    reqParams = constructReqParams(base64Encode(qId), tabeName, generateSign(), base64Encode(nextCursorMark), base64Encode(queryWord))<br>    reqHeaders = constructReqHeaders(generateXNrTraceId(), generateXNrSign(urlencode(reqParams)), userSid)<br><br>    req = requests.Request(method=<span class="hljs-string">&quot;GET&quot;</span>, url=url, headers=reqHeaders, params=reqParams)<br>    <span class="hljs-keyword">return</span> req<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">search</span>(<span class="hljs-params">keyword</span>):<br><br>    proxies = &#123;<br>        <span class="hljs-string">&quot;http&quot;</span>: <span class="hljs-string">&quot;127.0.0.1:7890&quot;</span>,<br>        <span class="hljs-string">&quot;https&quot;</span>: <span class="hljs-string">&quot;127.0.0.1:7890&quot;</span><br>    &#125;<br><br>    session = requests.Session()<br><br>    <span class="hljs-comment"># do while</span><br>    userSid = generateUserSid()<br>    tabeName = <span class="hljs-string">&quot;&quot;</span><br>    nextCursorMark = <span class="hljs-string">&quot;0&quot;</span><br>    qId = <span class="hljs-string">&quot;&quot;</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 正在进行关键词: <span class="hljs-subst">&#123;keyword&#125;</span> 的相关新闻搜索...&quot;</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        time.sleep(<span class="hljs-built_in">round</span>(random.uniform(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>), <span class="hljs-number">2</span>))<br>        req = constructRequest(keyword, tabeName, nextCursorMark, qId, userSid)<br>        prepared = session.prepare_request(req)<br>        <span class="hljs-comment"># print(prepared.url)</span><br>        <span class="hljs-comment"># print(json.dumps(dict(prepared.headers), indent=4, ensure_ascii=False))</span><br>        response = session.send(prepared, proxies=proxies)<br>        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>            <span class="hljs-comment"># print(json.dumps(response.json(), indent=4, ensure_ascii=False))</span><br>            rspResult = response.json()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 搜索结果如下:\n<span class="hljs-subst">&#123;rspResult&#125;</span>&quot;</span>)<br>            data = rspResult[<span class="hljs-string">&quot;data&quot;</span>]<br>            tabeName = data[<span class="hljs-string">&quot;curtabname&quot;</span>]<br>            <span class="hljs-comment"># do something to store the news</span><br>            news = data[<span class="hljs-string">&quot;doc&quot;</span>][<span class="hljs-string">&quot;result&quot;</span>]<br>            hasMore = data[<span class="hljs-string">&quot;doc&quot;</span>][<span class="hljs-string">&quot;has_more&quot;</span>]<br>            nextCursorMark = data[<span class="hljs-string">&quot;doc&quot;</span>][<span class="hljs-string">&quot;nextCursorMark&quot;</span>]<br>            qId = data[<span class="hljs-string">&quot;doc&quot;</span>][<span class="hljs-string">&quot;qId&quot;</span>]<br>            <span class="hljs-keyword">if</span> hasMore != <span class="hljs-number">1</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] 关键词: <span class="hljs-subst">&#123;keyword&#125;</span> 相关新闻已搜索完毕！请尝试更换其他关键词进行新闻搜索&quot;</span>)<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;网络请响应异常&quot;</span>)<br><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    search(<span class="hljs-string">&quot;火箭&quot;</span>)<br><br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Android%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98/" class="category-chain-item">Android逆向实战</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>某易新闻App逆向</div>
      <div>http://example.com/2025/12/24/逆向实战/网易新闻App逆向/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>gla2xy</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年12月24日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/12/25/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98/React%20App%E9%80%86%E5%90%91%E5%85%A5%E9%97%A8/" title="React App逆向入门">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">React App逆向入门</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/12/21/okhttp3/okhttp3%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="okhttp3学习笔记">
                        <span class="hidden-mobile">okhttp3学习笔记</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.1/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
